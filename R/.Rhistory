pdfplotspam <- function(M,m,L,C,E) {
  
  x = L[[1]][,1]
  y = (1:length(x) )*0
  y[1] = log2(M+1)
  y[2] = log2(m+1)
  #y[1] = 1
  #y[2] = 0
  
    
  plot(x,y,type="n",xlab="spamscore",ylab="log2(counts +1)")
  for (l in 1:length(L)) {
    
    inv = order(L[[l]][,2])
    logt = sum(log2(L[[l]][,inv]+1))
    t    = sum(L[[l]][,2])
    print (c(t,logt))
    
    T = log2(L[[l]][,2]+1)
    lines(L[[l]][,1],T, type="b",col=C[l])
  }

  legend(x="topright",legend=E,col=C,lty=5,lwd=2, bty="b")

  abline(v=50)


}

pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
pdfplotspam <- function(M,m,L,C,E) {
  
  x = L[[1]][,1]
  y = (1:length(x) )*0
  y[1] = log2(M+1)
  y[2] = log2(m+1)
  #y[1] = 1
  #y[2] = 0
  
    
  plot(x,y,type="n",xlab="spamscore",ylab="log2(counts +1)")
  for (l in 1:length(L)) {
    
    inv = order(L[[l]][,2])
    logt = sum(log2(L[[l]][inv,2]+1))
    t    = sum(L[[l]][,2])
    print (c(t,logt))
    
    T = log2(L[[l]][,2]+1)
    lines(L[[l]][,1],T, type="b",col=C[l])
  }

  legend(x="topright",legend=E,col=C,lty=5,lwd=2, bty="b")

  abline(v=50)


}

pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
help(plot)
pdfplotspam <- function(M,m,L,C,E) {
  
  x = L[[1]][,1]
  y = (1:length(x) )*0
  y[1] = log2(M+1)
  y[2] = log2(m+1)
  #y[1] = 1
  #y[2] = 0
  
    
  plot(x,y,type="n",xlab="spamscore",ylab="log2(counts +1)")
  for (l in 1:length(L)) {
    
    inv = order(L[[l]][,2])
    logt = sum(log2(L[[l]][inv,2]+1))
    t    = sum(L[[l]][,2])
    print (c(t,logt))
    
    T = log2(L[[l]][,2]+1)
    x =L[[l]][,1]
    print( c(max(x),min(x)))
    lines(x,T, type="b",col=C[l])
  }

  legend(x="topright",legend=E,col=C,lty=5,lwd=2, bty="b")

  abline(v=50)


}

pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
pdfplotspam <- function(M,m,L,C,E) {
  
  x = L[[1]][,1]
  y = (1:length(x) )*0
  y[1] = log2(M+1)
  y[2] = log2(m+1)
  #y[1] = 1
  #y[2] = 0
  
    
  plot(x,y,type="n",xlab="spamscore",ylab="log2(counts +1)")
  for (l in 1:length(L)) {
    
    inv = order(L[[l]][,2])
    logt = sum(log2(L[[l]][inv,2]+1))
    t    = sum(L[[l]][,2])
    print (c("V",t,logt))
    
    T = log2(L[[l]][,2]+1)
    x =L[[l]][,1]
    print( c("X", max(x),min(x)))
    lines(x,T, type="b",col=C[l])
  }

  legend(x="topright",legend=E,col=C,lty=5,lwd=2, bty="b")

  abline(v=50)


}

pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
L[[3]][[4]][,2]
sum(L[[3]][[4]][,2])
sum(L[[3]][[5]][,2])
sum(L[[3]][[5]][,2])
L[[3]][[5]][,2]
log2(L[[3]][[5]][,2]+1)
l = log2(L[[3]][[5]][,2]+1)
sum(l)
sum(l[order(l)])
sum(l[order(l,decreasing=TRUE)])
L = readspam(spam)
pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
cdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
pdf(file="pdfspam.pdf")
pdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
dev.off()
pdf(file="cdfspam.pdf")
cdfplotspam(L[[1]],L[[2]],L[[3]],spamcolor,spam)
dev.off()
exit
quit()
y
library(CDL)
source("CDL/R/CDLR.R")
Smolatest(10,10)
quit()
n

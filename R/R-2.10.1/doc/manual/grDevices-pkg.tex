
\chapter{The \texttt{grDevices} package}
\inputencoding{latin1}
\HeaderA{grDevices-package}{The R Graphics Devices and Support for Colours and Fonts}{grDevices.Rdash.package}
\aliasA{grDevices}{grDevices-package}{grDevices}
\keyword{package}{grDevices-package}
\keyword{device}{grDevices-package}
%
\begin{Description}\relax
Graphics devices and support for base and grid graphics
\end{Description}
%
\begin{Details}\relax

This package contains functions which support both
\LinkA{base}{graphics.Rdash.package} and \LinkA{grid}{grid.Rdash.package} graphics.

For a complete list of functions, use \code{library(help="grDevices")}.

\end{Details}
%
\begin{Author}\relax
R Development Core Team and contributors worldwide

Maintainer: R Core Team \email{R-core@r-project.org}
\end{Author}
\inputencoding{latin1}
\HeaderA{as.graphicsAnnot}{Coerce an Object for Graphics Annotation}{as.graphicsAnnot}
\keyword{utilities}{as.graphicsAnnot}
%
\begin{Description}\relax
Coerce an \R{} object into a form suitable for graphics annotation.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
as.graphicsAnnot(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an \R{} object
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Expressions, calls and names (as used by \LinkA{plotmath}{plotmath}) are passed
through unchanged.  All other objects with an S3 class (as determined
by \code{\LinkA{is.object}{is.object}}) are coerced by \code{\LinkA{as.character}{as.character}}
to character vectors.

All the \pkg{graphics} and \pkg{grid} functions which use this coerce
calls and names to expressions internally.
\end{Details}
%
\begin{Value}
A language object or a character vector.
\end{Value}
\inputencoding{latin1}
\HeaderA{boxplot.stats}{Box Plot Statistics}{boxplot.stats}
\keyword{dplot}{boxplot.stats}
%
\begin{Description}\relax
This function is typically called by another function to
gather the statistics necessary for producing box plots,
but may be invoked separately.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
boxplot.stats(x, coef = 1.5, do.conf = TRUE, do.out = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a numeric vector for which the boxplot will
be constructed (\code{\LinkA{NA}{NA}}s and \code{\LinkA{NaN}{NaN}}s are allowed
and omitted).
\item[\code{coef}] this determines how far the plot `whiskers' extend out
from the box.  If \code{coef} is positive, the whiskers extend to the
most extreme data point which is no more than \code{coef} times
the length of the box away from the box. A value of zero causes
the whiskers
to extend to the data extremes (and no outliers be returned).
\item[\code{do.conf,do.out}] logicals; if \code{FALSE}, the \code{conf} or
\code{out} component respectively will be empty in the result.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The two `hinges' are versions of the first and third quartile,
i.e., close to \code{\LinkA{quantile}{quantile}(x, c(1,3)/4)}.  The hinges equal
the quartiles for odd \eqn{n}{} (where \code{n <- length(x)}) and
differ for even \eqn{n}{}.  Whereas the quartiles only equal observations
for \code{n \%\% 4 == 1} (\eqn{n\equiv 1 \bmod 4}{}),
the hinges do so \emph{additionally} for \code{n \%\% 4 == 2}
(\eqn{n\equiv 2 \bmod 4}{}), and are in the middle of
two observations otherwise.

The notches (if requested) extend to \code{+/-1.58 IQR/sqrt(n)}.
This seems to be based on the same calculations as the formula with 1.57 in
Chambers \emph{et al.} (1983, p. 62), given in McGill \emph{et al.}
(1978, p. 16).  They are based on asymptotic normality of the median
and roughly equal sample sizes for the two medians being compared, and
are said to be rather insensitive to the underlying distributions of
the samples.  The idea appears to be to give roughly a 95\% confidence
interval for the difference in two medians.
\end{Details}
%
\begin{Value}
List with named components as follows:
\begin{ldescription}
\item[\code{stats}] a vector of length 5, containing the extreme of the
lower whisker, the lower `hinge', the median, the upper
`hinge' and the extreme of the upper whisker.
\item[\code{n}] the number of non-\code{NA} observations in the sample.
\item[\code{conf}] the lower and upper extremes of the `notch'
(\code{if(do.conf)}). See the details.
\item[\code{out}] the values of any data points which lie beyond the
extremes of the whiskers (\code{if(do.out)}).

\end{ldescription}
Note that \code{\$stats} and \code{\$conf} are sorted in \emph{in}creasing
order, unlike S, and that \code{\$n} and \code{\$out} include any
\code{+- Inf} values.
\end{Value}
%
\begin{References}\relax
Tukey, J. W. (1977) \emph{Exploratory Data Analysis.} Section 2C.

McGill, R., Tukey, J. W. and Larsen, W. A. (1978) Variations of box
plots. \emph{The American Statistician} \bold{32}, 12--16.

Velleman, P. F. and Hoaglin, D. C. (1981) \emph{Applications, Basics
and Computing of Exploratory Data Analysis.}  Duxbury Press.

Emerson, J. D and Strenio, J. (1983). Boxplots and batch comparison.
Chapter 3 of \emph{Understanding Robust and Exploratory Data
Analysis}, eds. D. C. Hoaglin, F. Mosteller and J. W. Tukey.  Wiley.

Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983)
\emph{Graphical Methods for Data Analysis.}  Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{fivenum}{fivenum}}, \code{\LinkA{boxplot}{boxplot}}, \code{\LinkA{bxp}{bxp}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
x <- c(1:100, 1000)
(b1 <- boxplot.stats(x))
(b2 <- boxplot.stats(x, do.conf=FALSE, do.out=FALSE))
stopifnot(b1 $ stats == b2 $ stats) # do.out=F is still robust
boxplot.stats(x, coef = 3, do.conf=FALSE)
## no outlier treatment:
boxplot.stats(x, coef = 0)

boxplot.stats(c(x, NA)) # slight change : n is 101
(r <- boxplot.stats(c(x, -1:1/0)))
stopifnot(r$out == c(1000, -Inf, Inf))




\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{cairo}{Cairo-based SVG, PDF and PostScript Graphics Devices}{cairo}
\aliasA{cairo\_pdf}{cairo}{cairo.Rul.pdf}
\aliasA{cairo\_ps}{cairo}{cairo.Rul.ps}
\aliasA{svg}{cairo}{svg}
\keyword{device}{cairo}
%
\begin{Description}\relax
Graphics devices for SVG, PDF and PostScript graphics files.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
svg(filename = if(onefile) "Rplots.svg" else "Rplot%03d.svg",
    width = 7, height = 7, pointsize = 12,
    onefile = FALSE, bg = "white",
    antialias = c("default", "none", "gray", "subpixel"))

cairo_pdf(filename = if(onefile) "Rplots.pdf" else "Rplot%03d.pdf",
          width = 7, height = 7, pointsize = 12,
          onefile = FALSE, bg = "white",
          antialias = c("default", "none", "gray", "subpixel"))

cairo_ps(filename = if(onefile) "Rplots.ps" else "Rplot%03d.ps",
         width = 7, height = 7, pointsize = 12,
         onefile = FALSE, bg = "white",
         antialias = c("default", "none", "gray", "subpixel"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] the name of the output file.
The page number is substituted if a C integer format is included in
the character string, as in the default.  (The result must be less
than \code{PATH\_MAX} characters long, and may be truncated if not.
See \code{\LinkA{postscript}{postscript}} for further details.)  Tilde expansion
is performed where supported by the platform.
\item[\code{width}] the width of the device in inches.
\item[\code{height}] the height of the device in inches.
\item[\code{pointsize}] the default pointsize of plotted text (in big points).
\item[\code{onefile}] should all plots appear in one file or in separate files?
\item[\code{bg}] the initial background colour: can be overridden by setting
par("bg").
\item[\code{antialias}] string, the type of anti-aliasing (if any) to be used;
defaults to \code{"default"}, see \code{\LinkA{X11}{X11}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
SVG (Scalar Vector Graphics) is a W3C standard for vector graphics.
See \url{http://www.w3.org/Graphics/SVG/}.  The output is SVG version
1.1 for \code{onefile = FALSE} (the default), otherwise SVG 1.2.  (Very few
SVG viewers are capable of displaying multi-page SVG files.)

Note that unlike \code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}},
\code{cairo\_pdf} and \code{cairo\_ps} sometimes record \emph{bitmaps}
and not vector graphics: a resolution of 72dpi is used.  On the other
hand, they can (on suitable platforms) include a much wider range of
UTF-8 glyphs, and embed the fonts used.  They are somewhat experimental.

\R{} can be compiled without support for any of these
devices: this will be reported if you attempt to use them on a system
where they are not supported.  They all require cairo version 1.2 or
later.

If you plot more than one page on one of these devices and do not
include something like \code{\%d} for the sequence number in
\code{file} (or set \code{onefile=TRUE}) the file will contain the
last page plotted.


The \code{cairo\_ps} output is not yet encapsulated (that is coming in
cairo 1.6).

There is full support of transparency, but using this is one of the
things liable to trigger bitmap output (and will always do so for
\code{cairo\_ps}).
\end{Details}
%
\begin{Value}
A plot device is opened: nothing is returned to the \R{} interpreter.
\end{Value}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is in pixels (\code{svg}) or inches.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are multiples of 1/96 inch.
\item Circle radii have a minumum of 1/72 inch.
\item Colours are interpreted by the viewing application.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{dev.print}{dev.print}}, \code{\LinkA{pdf}{pdf}},
\code{\LinkA{postscript}{postscript}}

\code{\LinkA{capabilities}{capabilities}} to see if cairo is supported.
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{check.options}{Set Options with Consistency Checks}{check.options}
\keyword{utilities}{check.options}
\keyword{programming}{check.options}
%
\begin{Description}\relax
Utility function for setting options with some consistency checks.
The \code{\LinkA{attributes}{attributes}} of the new settings in \code{new} are
checked for consistency with the \emph{model} (often default)
list in \code{name.opt}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
check.options(new, name.opt, reset = FALSE, assign.opt = FALSE,
              envir = .GlobalEnv,
              check.attributes = c("mode", "length"),
              override.check = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{new}] a \emph{named} list
\item[\code{name.opt}] character with the name of \R{} object containing the
default list.
\item[\code{reset}] logical; if \code{TRUE}, reset the options from
\code{name.opt}.  If there is more than one \R{} object with name
\code{name.opt}, remove the first one in the \code{\LinkA{search}{search}()} path.
\item[\code{assign.opt}] logical; if \code{TRUE}, assign the \ldots
\item[\code{envir}] the \code{\LinkA{environment}{environment}} used for \code{\LinkA{get}{get}}
and \code{\LinkA{assign}{assign}}.
\item[\code{check.attributes}] character containing the attributes which
\code{check.options} should check.
\item[\code{override.check}] logical vector of length \code{length(new)} (or 1
which entails recycling).
For those \code{new[i]} where \code{override.check[i] == TRUE}, the
checks are overridden and the changes made anyway.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list of components with the same names as the one called
\code{name.opt}.
The values of the components are changed from the \code{new} list,
as long as these pass the checks (when these are not overridden
according to \code{override.check}).
\end{Value}
%
\begin{Note}\relax
Option \code{"names"} is exempt from all the checks or warnings, as in
the application it can be \code{NULL} or a variable-length character
vector.
\end{Note}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{ps.options}{ps.options}} and \code{\LinkA{pdf.options}{pdf.options}},
which use \code{check.options}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
(L1 <- list(a=1:3, b=pi, ch="CH"))
check.options(list(a=0:2), name.opt = "L1")
check.options(NULL, reset = TRUE, name.opt = "L1")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{chull}{Compute Convex Hull of a Set of Points}{chull}
\keyword{graphs}{chull}
%
\begin{Description}\relax
Computes the subset of points which lie on the convex hull of the
set of points specified.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
chull(x, y = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] coordinate vectors of points. This can be specified as two
vectors \code{x} and \code{y}, a 2-column matrix \code{x}, a list
\code{x} with two components, etc, see \code{\LinkA{xy.coords}{xy.coords}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{\LinkA{xy.coords}{xy.coords}} is used to interpret the
specification of the points. The algorithm is that given by Eddy (1977).

`Peeling' as used in the S function \code{chull} can be
implemented by calling \code{chull} recursively.
\end{Details}
%
\begin{Value}
An integer vector giving the indices of the points lying on the
convex hull, in clockwise order.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Eddy, W. F. (1977) A new convex hull algorithm for planar sets.
\emph{ACM Transactions on Mathematical Software}, \bold{3}, 398--403.

Eddy, W. F. (1977) Algorithm 523. CONVEX, A new convex hull
algorithm for planar sets[Z]. \emph{ACM Transactions on
Mathematical Software}, \bold{3}, 411--412.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{xy.coords}{xy.coords}},\code{\LinkA{polygon}{polygon}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
X <- matrix(rnorm(2000), ncol = 2)
chull(X)
## Not run: 
  # Example usage from graphics package
  plot(X, cex = 0.5)
  hpts <- chull(X)
  hpts <- c(hpts, hpts[1])
  lines(X[hpts, ])

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{cm}{Unit Transformation}{cm}
\keyword{dplot}{cm}
%
\begin{Description}\relax
Translates from inches to cm (centimeters).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
cm(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] numeric vector
\end{ldescription}
\end{Arguments}
%
\begin{Examples}
\begin{ExampleCode}
cm(1)# = 2.54

## Translate *from* cm *to* inches:

10 / cm(1) # -> 10cm  are 3.937 inches
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{col2rgb}{Color to RGB Conversion}{col2rgb}
\keyword{color}{col2rgb}
\keyword{dplot}{col2rgb}
%
\begin{Description}\relax
\R{} color to RGB (red/green/blue) conversion.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
col2rgb(col, alpha = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{col}] vector of any of the three kind of \R{} colors, i.e., either
a color name (an element of \code{\LinkA{colors}{colors}()}), a hexadecimal
string of the form \code{"\#rrggbb"}, or an integer \code{i} meaning
\code{palette()[i]}.  Non-string values are coerced to integer.
\item[\code{alpha}] logical value indicating whether alpha channel
values should be returned.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For integer colors, \code{0} is shorthand for the current
\code{par("bg")} (and hence is only relevant to base graphics), and
\code{\LinkA{NA}{NA}} means transparent.

For character colors, \code{"NA"} is equivalent to \code{NA} above.
\end{Details}
%
\begin{Value}
an integer matrix with three or four rows and number of columns the length
(and names if any) as \code{col}.
\end{Value}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{rgb}{rgb}}, \code{\LinkA{colors}{colors}}, \code{\LinkA{palette}{palette}}, etc.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
col2rgb("peachpuff")
col2rgb(c(blu = "royalblue", reddish = "tomato")) # names kept

col2rgb(1:8)# the ones from the palette() :

col2rgb(paste("gold", 1:4, sep=""))

col2rgb("#08a0ff")
## all three kind of colors mixed :
col2rgb(c(red="red", palette= 1:3, hex="#abcdef"))

##-- NON-INTRODUCTORY examples --

grC <- col2rgb(paste("gray",0:100,sep=""))
table(print(diff(grC["red",])))# '2' or '3': almost equidistant
## The 'named' grays are in between {"slate gray" is not gray, strictly}
col2rgb(c(g66="gray66", darkg= "dark gray", g67="gray67",
          g74="gray74", gray =      "gray", g75="gray75",
          g82="gray82", light="light gray", g83="gray83"))

crgb <- col2rgb(cc <- colors())
colnames(crgb) <- cc
t(crgb)## The whole table

ccodes <- c(256^(2:0) %*% crgb)## = internal codes
## How many names are 'aliases' of each other:
table(tcc <- table(ccodes))
length(uc <- unique(sort(ccodes))) # 502
## All the multiply named colors:
mult <- uc[tcc >= 2]
cl <- lapply(mult, function(m) cc[ccodes == m])
names(cl) <- apply(col2rgb(sapply(cl, function(x)x[1])),
                   2, function(n)paste(n, collapse=","))
utils::str(cl)
## Not run: 
 if(require(xgobi)) { ## Look at the color cube dynamically :
   tc <- t(crgb[, !duplicated(ccodes)])
   table(is.gray <- tc[,1] == tc[,2] & tc[,2] == tc[,3])# (397, 105)
   xgobi(tc, color = c("gold", "gray")[1 + is.gray])
 }

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{colorRamp}{Color interpolation}{colorRamp}
\aliasA{colorRampPalette}{colorRamp}{colorRampPalette}
\keyword{color}{colorRamp}
%
\begin{Description}\relax
These functions return functions that interpolate a set of given
colors to create new color palettes (like \code{\LinkA{topo.colors}{topo.colors}}) and
color ramps, functions that map the interval \eqn{[0, 1]}{} to colors
(like \code{\LinkA{grey}{grey}}).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
colorRamp(colors, bias = 1, space = c("rgb", "Lab"),
          interpolate = c("linear", "spline"))
colorRampPalette(colors, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{colors}] Colors to interpolate 
\item[\code{bias}] A positive number. Higher values give more widely spaced
colors at the high end.
\item[\code{space}] Interpolation in RGB or CIE Lab color spaces
\item[\code{interpolate}] Use spline or linear interpolation.
\item[\code{...}] arguments to pass to \code{colorRamp}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The CIE Lab color space is approximately perceptually uniform, and so
gives smoother and more uniform color ramps. On the other hand,
palettes that vary from one hue to another via white may have a more
symmetrical appearance in RGB space.

The conversion formulas in this function do not appear to be
completely accurate and the color ramp may not reach the extreme
values in Lab space.  Future changes in the \R{} color model may change
the colors produced with \code{space="Lab"}.
\end{Details}
%
\begin{Value}
\code{colorRamp} returns a function that maps values between 0 and 1
to colors.
\code{colorRampPalette} returns a function that takes an integer
argument and returns that number of colors interpolating the given
sequence (similar to \code{\LinkA{heat.colors}{heat.colors}} or
\code{\LinkA{terrain.colors}{terrain.colors}}.
\end{Value}
%
\begin{SeeAlso}\relax
Good starting points for interpolation are the "sequential"
and "diverging" ColorBrewer palettes in the RColorBrewer package
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

## Here space="rgb" gives palettes that vary only in saturation,
## as intended.
## With space="Lab" the steps are more uniform, but the hues
## are slightly purple.
filled.contour(volcano,
               color.palette =
                   colorRampPalette(c("red", "white", "blue")),
               asp = 1)
filled.contour(volcano,
               color.palette =
                   colorRampPalette(c("red", "white", "blue"),
                                    space = "Lab"),
               asp = 1)

## Interpolating a 'sequential' ColorBrewer palette
YlOrBr <- c("#FFFFD4", "#FED98E", "#FE9929", "#D95F0E", "#993404")
filled.contour(volcano,
               color.palette = colorRampPalette(YlOrBr, space = "Lab"),
               asp = 1)
filled.contour(volcano,
               color.palette = colorRampPalette(YlOrBr, space = "Lab",
                                                bias = 0.5),
               asp = 1)

## 'jet.colors' is "as in Matlab"
## (and hurting the eyes by over-saturation)
jet.colors <-
  colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
                     "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
filled.contour(volcano, color = jet.colors, asp = 1)

## space="Lab" helps when colors don't form a natural sequence
m <- outer(1:20,1:20,function(x,y) sin(sqrt(x*y)/3))
rgb.palette <- colorRampPalette(c("red", "orange", "blue"),
                                space = "rgb")
Lab.palette <- colorRampPalette(c("red", "orange", "blue"),
                                space = "Lab")
filled.contour(m, col = rgb.palette(20))
filled.contour(m, col = Lab.palette(20))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{colors}{Color Names}{colors}
\aliasA{colours}{colors}{colours}
\keyword{color}{colors}
\keyword{dplot}{colors}
\keyword{sysdata}{colors}
%
\begin{Description}\relax
Returns the built-in color names which \R{} knows about.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
colors()
colours()
\end{verbatim}
\end{Usage}
%
\begin{Details}\relax
These color names can be used with a \code{col=} specification in
graphics functions.

An even wider variety of colors can be created with primitives
\code{rgb} and \code{hsv} or the derived \code{rainbow},
\code{heat.colors}, etc.
\end{Details}
%
\begin{Value}
A character vector containing all the built-in color names.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{palette}{palette}} for setting the `palette' of colors for
\code{par(col=}\emph{<num>}\code{)};
\code{\LinkA{rgb}{rgb}}, \code{\LinkA{hsv}{hsv}}, \code{\LinkA{hcl}{hcl}}, \code{\LinkA{gray}{gray}};
\code{\LinkA{rainbow}{rainbow}} for a nice example;
and \code{\LinkA{heat.colors}{heat.colors}}, \code{\LinkA{topo.colors}{topo.colors}} for images.

\code{\LinkA{col2rgb}{col2rgb}} for translating to RGB numbers and extended
examples.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
cl <- colors()
length(cl); cl[1:20]
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{contourLines}{Calculate Contour Lines}{contourLines}
\keyword{dplot}{contourLines}
%
\begin{Description}\relax
Calculate contour lines for a given set of data.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
contourLines(x = seq(0, 1, length.out = nrow(z)),
             y = seq(0, 1, length.out = ncol(z)),
             z, nlevels = 10,
             levels = pretty(range(z, na.rm=TRUE), nlevels))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] locations of grid lines at which the values in \code{z} are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If \code{x} is a \code{list},
its components \code{x\$x} and \code{x\$y} are used for \code{x}
and \code{y}, respectively. If the list has component \code{z} this
is used for \code{z}.
\item[\code{z}] a matrix containing the values to be plotted (\code{NA}s are
allowed).  Note that \code{x} can be used instead of \code{z} for
convenience.
\item[\code{nlevels}] number of contour levels desired \bold{iff}
\code{levels} is not supplied.
\item[\code{levels}] numeric vector of levels at which to draw contour
lines.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{contourLines} draws nothing, but returns a set of contour lines.

There is currently no documentation about the algorithm.
The source code is in \file{\var{\LinkA{R\_HOME}{R.Rul.HOME}}/src/main/plot3d.c}.
\end{Details}
%
\begin{Value}
A list of contours.
Each contour is a list with elements:
\begin{ldescription}
\item[\code{level }] The contour level.
\item[\code{x }] The x-coordinates of the contour.
\item[\code{y }] The y-coordinates of the contour.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{options}{options}("max.contour.segments")} for the maximal
complexity of a single contour line.

\code{\LinkA{contour}{contour}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- 10*1:nrow(volcano)
y <- 10*1:ncol(volcano)
contourLines(x, y, volcano)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{convertColor}{Convert between colour spaces}{convertColor}
\aliasA{colorspaces}{convertColor}{colorspaces}
\keyword{color}{convertColor}
%
\begin{Description}\relax
Convert colours between standard colour space representations. This
function is experimental.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
convertColor(color, from, to, from.ref.white, to.ref.white,
             scale.in=1, scale.out=1, clip=TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{color}] A matrix whose rows specify colors. 
\item[\code{from,to }] Input and output color spaces.  See `Details' below.
\item[\code{from.ref.white,to.ref.white}] Reference whites or \code{NULL}
if these are built in to the definition, as for RGB
spaces. \code{D65} is the default, see `Details' for others.

\item[\code{scale.in, scale.out}] Input is divided by \code{scale.in}, output
is multiplied by \code{scale.out}. Use \code{NULL} to suppress
scaling when input or output is not numeric.
\item[\code{clip}] If \code{TRUE}, truncate RGB output to [0,1],
\code{FALSE} return out-of-range RGB, \code{NA} set out of range
colors to \code{NaN}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Color spaces are specified by objects of class \code{colorConverter},
created by \code{\LinkA{colorConverter}{colorConverter}} or
\code{\LinkA{make.rgb}{make.rgb}}. Built-in color spaces may be referenced by
strings: \code{"XYZ"}, \code{"sRGB"}, \code{"Apple RGB"}, \code{"CIE RGB"},
\code{"Lab"}, \code{"Luv"}. The converters for these colour spaces are
in the object \code{colorspaces}.

The \code{"sRGB"} color space is that used by standard PC monitors.
\code{"Apple RGB"} is used by Apple monitors. \code{"Lab"} and
\code{"Luv"}
are approximately perceptually uniform
spaces standardized by the Commission Internationale
d'Eclairage. \code{XYZ} is a 1931 CIE standard capable of representing
all visible colors (and then some), but not in a perceptually uniform
way.

The \code{Lab} and \code{Luv} spaces describe colors of objects, and
so require the specification of a reference `white light'
color.  Illuminant \code{D65} is a standard indirect daylight,
Illuminant \code{D50} is close to direct sunlight, and Illuminant
\code{A} is the light from a standard incandescent bulb. Other
standard CIE illuminants supported are \code{B}, \code{C}, \code{E} and
\code{D55}.  RGB colour spaces are defined relative to a particular
reference white, and can be only approximately translated to other
reference whites.  The Bradford chromatic adaptation algorithm is used
for this.

The RGB color spaces are specific to a particular class of display.
An RGB space cannot represent all colors, and the \code{clip} option
controls what is done to out-of-range colors.
\end{Details}
%
\begin{Value}
A 3-row matrix whose columns specify the colors.
\end{Value}
%
\begin{References}\relax
For all the conversion equations
\url{http://www.brucelindbloom.com/}

For the white points
\url{http://www.efg2.com/Lab/Graphics/Colors/Chromaticity.htm}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{col2rgb}{col2rgb}} and \code{\LinkA{colors}{colors}} for ways to specify
colors in graphics.

\code{\LinkA{make.rgb}{make.rgb}} for specifying other colour spaces.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics); require(stats) # for na.omit
par(mfrow=c(2,2))
## The displayable colors from four planes of Lab space
ab <- expand.grid(a=(-10:15)*10,b=(-15:10)*10)

Lab <- cbind(L=20,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=20")

Lab <- cbind(L=40,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=40")

Lab <- cbind(L=60,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=60")

Lab <- cbind(L=80,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=80")


(cols <- t(col2rgb(palette())))
(lab <- convertColor(cols,from="sRGB",to="Lab",scale.in=255))
round(convertColor(lab,from="Lab",to="sRGB",scale.out=255))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{densCols}{Colors for Smooth Density Plots}{densCols}
\aliasA{blues9}{densCols}{blues9}
\keyword{dplot}{densCols}
%
\begin{Description}\relax
\code{densCols} produces a vector containing colors which encode the
local densities at each point in a scatterplot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
densCols(x, y = NULL, nbin = 128, bandwidth,
         colramp = colorRampPalette(blues9[-(1:3)]))
blues9
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the \code{x} and \code{y} arguments provide the x and y
coordinates of the points.  Any reasonable way of defining the
coordinates is acceptable.  See the function \code{\LinkA{xy.coords}{xy.coords}}
for details.  If supplied separately, they must be of the same length.
\item[\code{nbin}] numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
\code{gridsize} in \code{\LinkA{bkde2D}{bkde2D}()}.
\item[\code{bandwidth}] numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. \code{bandwidth}
is subsequently passed to function \code{\LinkA{bkde2D}{bkde2D}}.
\item[\code{colramp}] function accepting an integer \code{n} as an argument and
returning \code{n} colors.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{densCols} computes and returns the set of colors that will be
used in plotting.

\code{blues9} is a set of 9 color shades of blue used as the default in
plotting.
\end{Details}
%
\begin{Value}
\code{densCols} returns a vector of length \code{nrow(x)} that
contains colors to be used in a subsequent scatterplot.  Each color
represents the local density around the corresponding point.
\end{Value}
%
\begin{Author}\relax
Florian Hahne at FHCRC, originally
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{bkde2D}{bkde2D}} from package \pkg{KernSmooth},
and \code{\LinkA{smoothScatter}{smoothScatter}()} which builds on the same
computations as \code{densCols}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x1  <- matrix(rnorm(1e3), ncol=2)
x2  <- matrix(rnorm(1e3, mean=3, sd=1.5), ncol=2)
x   <- rbind(x1,x2)

dcols <- densCols(x)
graphics::plot(x, col = dcols, pch=20, main = "n = 1000")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{dev}{Control Multiple Devices}{dev}
\methaliasA{dev.cur}{dev}{dev.cur}
\methaliasA{dev.list}{dev}{dev.list}
\methaliasA{dev.new}{dev}{dev.new}
\methaliasA{dev.next}{dev}{dev.next}
\methaliasA{dev.off}{dev}{dev.off}
\methaliasA{dev.prev}{dev}{dev.prev}
\methaliasA{dev.set}{dev}{dev.set}
\aliasA{graphics.off}{dev}{graphics.off}
\keyword{device}{dev}
\keyword{iplot}{dev}
%
\begin{Description}\relax
These functions provide control over multiple graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.cur()
dev.list()
dev.next(which = dev.cur())
dev.prev(which = dev.cur())
dev.off(which = dev.cur())
dev.set(which = dev.next())
dev.new(...)
graphics.off()
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{which}] An integer specifying a device number.
\item[\code{...}] arguments to be passed to the device selected.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Only one device is the `active' device: this is the device in
which all graphics operations occur.  There is a \code{"null device"}
which is always open but is really a placeholder: any attempt to use
it will open a new device specified by
\code{\LinkA{getOption}{getOption}("device")}).

Devices are associated with a name (e.g., \code{"X11"} or
\code{"postscript"}) and a number in the range 1 to 63; the
\code{"null device"} is always device 1.  Once a device has been
opened the null device is not considered as a possible active device.
There is a list of open devices, and this is considered as a circular
list not including the null device.  \code{dev.next} and
\code{dev.prev} select the next open device in the appropriate
direction, unless no device is open.

\code{dev.off} shuts down the specified (by default the current)
device.  If the current device is shut down and any other devices are
open, the next open device is made current.  It is an error to
attempt to shut down device 1.  \code{graphics.off()} shuts down all
open graphics devices.  Normal termination of a session runs the
internal equivalent of \code{graphics.off()}.

\code{dev.set} makes the specified device the active device.  If there
is no device with that number, it is equivalent to \code{dev.next}.
If \code{which = 1} it opens a new device and selects that.

\code{dev.new} opens a new device.  Normally \R{} will open a new device
automatically when needed, but this enables you to open further
devices in a platform-independent way.  (For which device is used see
\code{\LinkA{getOption}{getOption}("device")}.)  Note that care is needed with
file-based devices such as \code{\LinkA{pdf}{pdf}} and
\code{\LinkA{postscript}{postscript}} and in that case file names such as
\file{Rplots.pdf}, \file{Rplots1.pdf}, \dots, \file{Rplots999.pdf} are
tried in turn.  Only named arguments are passed to the device, and
then only if they match the argument list of the device.  Even so,
case is needed with the interpretation of e.g. \code{width}, and for
the standard bitmap devices \code{units="in", res=72} is forced if
neither is supplied but both \code{width} and \code{height} are.
\end{Details}
%
\begin{Value}
\code{dev.cur} returns a length-one named integer vector giving the
number and name of the active device, or 1, the null device, if none
is active.

\code{dev.list} returns the numbers of all open devices, except device
1, the null device.  This is a numeric vector with a
\code{\LinkA{names}{names}} attribute giving the device names, or \code{NULL} is
there is no open device.

\code{dev.next} and \code{dev.prev} return the number and name of the
next / previous device in the list of devices.  This will be the null
device if and only if there are no open devices.

\code{dev.off} returns the number and name of the new active device
(after the specified device has been shut down).

\code{dev.set} returns the number and name of the new active device.

\code{dev.new} returns the return value of the device opened, usually
invisible \code{NULL}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, such as \code{\LinkA{postscript}{postscript}}, etc.

\code{\LinkA{layout}{layout}} and its links for setting up plotting regions
on the current device.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: ## Unix-specific example
x11()
plot(1:10)
x11()
plot(rnorm(10))
dev.set(dev.prev())
abline(0,1)# through the 1:10 points
dev.set(dev.next())
abline(h=0, col="gray")# for the residual plot
dev.set(dev.prev())
dev.off(); dev.off()#- close the two X devices

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{dev.interactive}{Is the Current Graphics Device Interactive ?}{dev.interactive}
\aliasA{deviceIsInteractive}{dev.interactive}{deviceIsInteractive}
\keyword{device}{dev.interactive}
%
\begin{Description}\relax
Test if the current graphics device (or that which would be opened) is
interactive.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.interactive(orNone = FALSE)

deviceIsInteractive(name = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{orNone}] logical; if \code{TRUE}, the function also returns
\code{TRUE} when \code{\LinkA{.Device}{.Device} == "null device"} and
\code{\LinkA{getOption}{getOption}("device")} is among the known
interactive devices.
\item[\code{name}] one or more device names as a character vector,
or \code{NULL} to give the existing list.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The \code{X11} (Unix), \code{windows} (Windows) and \code{quartz}
(Mac OS X, on-screen types only) are regarded as interactive, together
with \code{JavaGD} (from the package of the same name) and
\code{CairoWin} and \code{CairoX11} (from package \pkg{Cairo}).
Packages can add their devices to the list by calling
\code{deviceIsInteractive}.
\end{Details}
%
\begin{Value}
\code{dev.interactive()} returns a logical, \code{TRUE} if and only if an
interactive (screen) device is in use.

\code{deviceIsInteractive} returns the updated list of known
interactive devices, invisibly unless \code{name = NULL}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}} for the available devices on your platform.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
dev.interactive()
print(deviceIsInteractive(NULL))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{dev.size}{Find Size of Device Surface}{dev.size}
\keyword{dplot}{dev.size}
%
\begin{Description}\relax
Find the dimensions of the device surface of the current device.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.size(units = c("in", "cm", "px"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{units}] the units in which to return the value -- inches, cm, or
pixels (device units).
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A two-element numeric vector giving width and height of the current
device; a new device is opened if there is none, similarly to
\code{\LinkA{dev.new}{dev.new}()}.
\end{Value}
%
\begin{SeeAlso}\relax
The size information in inches can be obtained by
\code{\LinkA{par}{par}("din")}, but this provides a way to access it
independent of the graphics sub-system in use.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
dev.size("cm")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{dev2}{Copy Graphics Between Multiple Devices}{dev2}
\aliasA{dev.control}{dev2}{dev.control}
\aliasA{dev.copy}{dev2}{dev.copy}
\aliasA{dev.copy2eps}{dev2}{dev.copy2eps}
\aliasA{dev.copy2pdf}{dev2}{dev.copy2pdf}
\aliasA{dev.print}{dev2}{dev.print}
\keyword{device}{dev2}
%
\begin{Description}\relax
\code{dev.copy} copies the graphics contents of the current device
to the device specified by \code{which} or to a new device which has
been created by the function specified by \code{device} (it is an
error to specify both \code{which} and \code{device}).  (If recording
is off on the current device, there are no contents to copy: this will
result in no plot or an empty plot.)
The device copied to becomes the current device.

\code{dev.print} copies the graphics contents of the current device
to a new device which has been created by the function specified by
\code{device} and then shuts the new device.

\code{dev.copy2eps} is similar to \code{dev.print} but produces an
EPSF output file in portrait orientation (\code{horizontal = FALSE}).
\code{dev.copy2pdf} is the analogue for PDF output.

\code{dev.control} allows the user to control the recording of
graphics operations in a device.  If \code{displaylist} is \code{"inhibit"}
(\code{"enable"}) then recording is turned off (on). It is only safe
to change this at the beginning of a plot (just before or just after a
new page).  Initially recording is on for screen devices, and off for
print devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.copy(device, ..., which = dev.next())
dev.print(device = postscript, ...)
dev.copy2eps(...)
dev.copy2pdf(..., out.type = "pdf")
dev.control(displaylist = c("inhibit", "enable"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{device}] A device function (e.g., \code{x11},
\code{postscript}, \ldots)
\item[\code{...}] Arguments to the \code{device} function above: for
\code{dev.copy2eps} arguments to \code{\LinkA{postscript}{postscript}} and for
\code{dev.copy2pdf}, arguments to \code{\LinkA{pdf}{pdf}}.
For \code{dev.print}, this includes \code{which} and by default any
\code{\LinkA{postscript}{postscript}} arguments.
\item[\code{which}] A device number specifying the device to copy to.
\item[\code{out.type}] The name of the output device: can be \code{"pdf"}, or
\code{"quartz"} (some Mac OS X builds) or \code{"cairo"} (some
Unix-alikes, see \code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}}).
\item[\code{displaylist}] A character string: the only valid values are
\code{"inhibit"} and \code{"enable"}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Note that these functions copy the \emph{device region} and not a
plot: the background colour of the device surface is part of what is
copied.  Most screen devices default to a transparent background, which
is probably not what is needed when copying to a device such as
\code{\LinkA{png}{png}}.

For \code{dev.copy2eps} and \code{dev.copy2pdf}, \code{width} and
\code{height} are taken from the current device unless otherwise
specified.  If just one of \code{width} and \code{height} is
specified, the other is adjusted to preserve the aspect ratio of the
device being copied.  The default file name is \code{Rplot.eps} or
\code{Rplot.pdf}, and can be overridden by specifying a \code{file}
argument.

Copying to devices such as \code{\LinkA{postscript}{postscript}} and
\code{\LinkA{pdf}{pdf}} which need font families pre-specified needs extra
care -- \R{} is unaware of which families were used in a plot and so
they will need to manually specified by the \code{fonts} argument
passed as part of \code{...}.  Similarly, if the device to be copied
from was opened with a \code{family} argument, a suitable
\code{family} argument will need to be included in \code{...}.

The default for \code{dev.print} is to produce and print a postscript
copy, if \code{\LinkA{options}{options}("printcmd")} is set suitably.


\code{dev.print} is most useful for producing a postscript print
(its default) when the following applies.  Unless
\code{file} is specified, the plot will be printed.  Unless
\code{width}, \code{height} and \code{pointsize} are specified
the plot dimensions will be taken from the current device, shrunk
if necessary to fit on the paper. (\code{pointsize} is rescaled if the
plot is shrunk.)  If \code{horizontal} is not specified and the plot
can be printed at full size by switching its value this is done
instead of shrinking the plot region.

If \code{dev.print} is used with a specified \code{device} (even
\code{postscript}) it sets the width and height in the same way as
\code{dev.copy2eps}.  This will not be appropriate unless the device
specifies dimensions in inches, in particular not for
\code{png}, \code{jpeg}, \code{tiff} and \code{bmp} unless
\code{units="inches"} is specified.
\end{Details}
%
\begin{Value}
\code{dev.copy} returns the name and number of the device which has
been copied to.

\code{dev.print}, \code{dev.copy2eps} and \code{dev.copy2pdf} return
the name and number of the device which has been copied from.
\end{Value}
%
\begin{Note}\relax
Most devices (including all screen devices) have a display list
which records all of the graphics operations that occur in the device.
\code{dev.copy} copies graphics contents by copying the display list
from one device to another device.  Also, automatic redrawing of
graphics contents following the resizing of a device depends on the
contents of the display list.

After the command \code{dev.control("inhibit")}, graphics operations
are not recorded in the display list so that \code{dev.copy} and
\code{dev.print} will not copy anything and the contents of a device
will not be redrawn automatically if the device is resized.

The recording of graphics operations is relatively expensive in
terms of memory so the command \code{dev.control("inhibit")} can be
useful if memory usage is an issue.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{dev.cur}{dev.cur}} and other \code{dev.xxx} functions.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
x11()
plot(rnorm(10), main="Plot 1")
dev.copy(device=x11)
mtext("Copy 1", 3)
dev.print(width=6, height=6, horizontal=FALSE) # prints it
dev.off(dev.prev())
dev.off()

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{dev2bitmap}{Graphics Device for Bitmap Files via GhostScript}{dev2bitmap}
\aliasA{bitmap}{dev2bitmap}{bitmap}
\keyword{utilities}{dev2bitmap}
%
\begin{Description}\relax
\code{bitmap} generates a graphics file.
\code{dev2bitmap} copies the current graphics device to a file in a
graphics format.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bitmap(file, type = "png16m", height = 7, width = 7, res = 72,
       units = "in", pointsize, taa = NA, gaa = NA, ...)

dev2bitmap(file, type = "png16m", height = 7, width = 7, res = 72,
           units = "in", pointsize, ...,
           method = c("postscript", "pdf"), taa = NA, gaa = NA)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] The output file name, with an appropriate extension.
\item[\code{type}] The type of bitmap. the default is \code{"png256"}.
\item[\code{width, height}] Dimensions of the display region.
\item[\code{res}] Resolution, in dots per inch.
\item[\code{units}] The units in which \code{height} and \code{width} are
given.  Can be \code{in} (inches), \code{px} (pixels), \code{cm} or
\code{mm}.
\item[\code{pointsize}] The pointsize to be used for text: defaults to
something reasonable given the width and height
\item[\code{...}] Other parameters passed to \code{\LinkA{postscript}{postscript}} or
\code{\LinkA{pdf}{pdf}}.
\item[\code{method}] Should the plot be done by \code{\LinkA{postscript}{postscript}} or
\code{\LinkA{pdf}{pdf}}?
\item[\code{taa, gaa}] Number of bits of antialiasing for text and for graphics
respectively.  Usually 4 (for best effect) or 2.  Not supported on
all types.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{dev2bitmap} works by copying the current device to a
\code{\LinkA{postscript}{postscript}} or \code{\LinkA{pdf}{pdf}} device, and
post-processing the output file using \code{ghostscript}.
\code{bitmap} works in the same way using a \code{postscript} device
and post-processing the output as `printing'.

You will need \code{ghostscript}: the full path to the executable can
be set by the environment variable \env{R\_GSCMD}.
(If this is unset the command \code{"gs"} is used, which will work if
it is in your path.)

The types available will depend on the version of \code{ghostscript},
but are likely to include
\code{"pcxmono"}, \code{"pcxgray"}, \code{"pcx16"}, \code{"pcx256"},
\code{"pcx24b"}, \code{"pcxcmyk"}, \code{"pbm"}, \code{"pbmraw"},
\code{"pgm"}, \code{"pgmraw"}, \code{"pgnm"}, \code{"pgnmraw"},
\code{"pnm"}, \code{"pnmraw"}, \code{"ppm"}, \code{"ppmraw"},
\code{"pkm"}, \code{"pkmraw"}, \code{"tiffcrle"}, \code{"tiffg3"},
\code{"tiffg32d"}, \code{"tiffg4"}, \code{"tifflzw"},
\code{"tiffpack"}, \code{"tiff12nc"}, \code{"tiff24nc"},
\code{"psmono"}, \code{"psgray"}, \code{"psrgb"}, \code{"bit"},
\code{"bitrgb"}, \code{"bitcmyk"}, \code{"pngmono"}, \code{"pnggray"},
\code{"pngalpha"}, \code{"png16"}, \code{"png256"}, \code{"png16m"},
\code{"png48"}, \code{"jpeg"}, \code{"jpeggray"}, \code{"pdfwrite"}.

The default type, \code{"png16m"} supports 24-bit colour and
anti-aliasing.  Versions of \R{} prior to 2.7.0 defaulted to
\code{"png256"}, which uses a palette of 256 colours and could be a
more compact representation.  Monochrome graphs can use
\code{"pngmono"}, or \code{"pnggray"} if anti-aliasing is desired.

Note that for a colour TIFF image you probably want \code{"tiff24nc"},
which is 8-bit per channel RGB (the most common TIFF format).  None of
the listed TIFF types support transparency.

For formats which contain a single image, a file specification like
\code{Rplots\%03d.png} can be used: this is interpreted by GhostScript.

For \code{dev2bitmap} if just one of \code{width} and \code{height} is
specified, the other is chosen to preserve aspect ratio of the
device being copied.  The main reason to prefer \code{method = "pdf"}
over the default would be to allow semi-transparent colours to be used.

For graphics parameters such as \code{"cra"} that need to work in
pixels, the default resolution of 72dpi is always used.

\end{Details}
%
\begin{Value}
None.
\end{Value}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.  These
devices follow the underlying device, so when viewed at the stated
\code{res}:

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is (for the standard GhostScript
setup) URW Nimbus Sans.
\item Line widths are as a multiple of 1/96 inch, with no minimum. 
\item Circle of any radius are allowed.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{savePlot}{savePlot}}, which for \code{windows} and
\code{X11(type = "Cairo")} provides a simple way to record a PNG
record of the current plot.

\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf}{pdf}}, \code{\LinkA{png}{png}},
\code{\LinkA{jpeg}{jpeg}}, \code{\LinkA{tiff}{tiff}} and  \code{bmp}.

To display an array of data, see \code{\LinkA{image}{image}}.
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{devAskNewPage}{Prompt before New Page}{devAskNewPage}
\keyword{dplot}{devAskNewPage}
%
\begin{Description}\relax
This function can be used to control (for the current device)
whether the user is prompted before starting a new page of output.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
devAskNewPage(ask = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{ask}] \code{NULL} or a logical value.  If \code{TRUE}, the user
is prompted before a new page of output is started. 
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If the current device is the null device, this will open a graphics device.

The default argument just returns the current setting and does not
change it.

The default value when a device is opened is taken from the
setting of \code{\LinkA{options}{options}("device.ask.default")}.

The precise circumstances when the user will be asked to confirm a new
page depend on the graphics subsystem.  Obviously this needs to be an
interactive session.  In addition `recording' needs to be in
operation, so only when the display list is enabled (see
\code{\LinkA{dev.control}{dev.control}}) which it usually is only on a screen device.
\end{Details}
%
\begin{Value}
The current prompt setting \emph{before} any new setting is applied.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.new}{plot.new}}, \code{\LinkA{grid.newpage}{grid.newpage}}
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{Devices}{List of Graphical Devices}{Devices}
\aliasA{device}{Devices}{device}
\keyword{device}{Devices}
%
\begin{Description}\relax
The following graphics devices are currently available:
\begin{itemize}

\item \code{\LinkA{postscript}{postscript}} Writes PostScript graphics commands to
a file
\item \code{\LinkA{pdf}{pdf}} Write PDF graphics commands to a file
\item \code{\LinkA{pictex}{pictex}} Writes LaTeX/PicTeX graphics commands to a
file
\item \code{\LinkA{png}{png}} PNG bitmap device
\item \code{\LinkA{jpeg}{jpeg}} JPEG bitmap device
\item \code{\LinkA{bmp}{bmp}} BMP bitmap device
\item \code{\LinkA{tiff}{tiff}} TIFF bitmap device
\item \code{\LinkA{xfig}{xfig}} Device for XFIG graphics file format
\item \code{\LinkA{bitmap}{bitmap}} bitmap pseudo-device via
\code{GhostScript} (if available).

\end{itemize}

The following devices will be functional if \R{} was compiled to use
them (they exist but will return with a warning on other systems):
\begin{itemize}

\item \code{\LinkA{X11}{X11}} The graphics device for the X11 Window system
\item \code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}}, \code{cairo\_ps} PDF and PostScript
devices based on cairo graphics.

\item \code{\LinkA{quartz}{quartz}} The graphics device for the Mac OS X
native Quartz 2d graphics system.  (This is only functional on Mac
OS X where it can be used from the \code{R.app} GUI and from the
command line: but it will display on the local screen even for a
remote session.)

\end{itemize}

\end{Description}
%
\begin{Details}\relax
If no device is open, using a high-level graphics function will cause
a device to be opened.  Which device is given by
\code{\LinkA{options}{options}("device")} which is initially set as the most
appropriate for each platform: a screen device for most interactive use and
\code{\LinkA{pdf}{pdf}} (or the setting of \env{R\_DEFAULT\_DEVICE})
otherwise.  The exception is interactive use under Unix if no screen
device is known to be available, when \code{pdf()}is used.
\end{Details}
%
\begin{SeeAlso}\relax
The individual help files for further information on any of the
devices listed here;
\code{\LinkA{X11}{X11}.options}, \code{\LinkA{quartz.options}{quartz.options}},
\code{\LinkA{ps.options}{ps.options}} and \code{\LinkA{pdf.options}{pdf.options}} for how to
customize devices.

\code{\LinkA{dev.interactive}{dev.interactive}},
\code{\LinkA{dev.cur}{dev.cur}}, \code{\LinkA{dev.print}{dev.print}},
\code{\LinkA{graphics.off}{graphics.off}}, \code{\LinkA{image}{image}},
\code{\LinkA{dev2bitmap}{dev2bitmap}}.

\code{\LinkA{capabilities}{capabilities}} to see if \code{\LinkA{X11}{X11}}, \code{\LinkA{jpeg}{jpeg}}
\code{\LinkA{png}{png}} and \code{\LinkA{quartz}{quartz}} are available.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## open the default screen device on this platform if no device is
## open
if(dev.cur() == 1) dev.new()

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{embedFonts}{Embed Fonts in PostScript and PDF}{embedFonts}
\keyword{device}{embedFonts}
%
\begin{Description}\relax
Runs Ghostscript to process a PDF or PostScript file and
embed all fonts in the file.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
embedFonts(file, format, outfile = file, fontpaths = "",
           options = "")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the original file.
\item[\code{format}] either \code{"pswrite"} or \code{"pdfwrite"}.
If not specified, it is guessed from the suffix of \code{file}.
\item[\code{outfile}] the name of the new file (with fonts embedded).
\item[\code{fontpaths}] a character vector giving directories that
Ghostscript will search for fonts.
\item[\code{options}] a character string containing further options to
Ghostscript.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This function is not necessary if you just use the standard
default fonts for PostScript and PDF output.

If you use a special font, this function is useful for
embedding that font in your PostScript or PDF document
so that it can be shared with others without them having
to install your special font (provided the font licence allows this).

If the special font is not installed for Ghostscript,
you will need to tell Ghostscript where the font is, using
something like \code{options="-sFONTPATH=path/to/font"}.

This function relies on a suitable Ghostscript executable being in
your path, or the environment variable \env{R\_GSCMD} (the same as
\code{\LinkA{bitmap}{bitmap}}) being set as the full path to the Ghostscript
executable.
This defaults to \code{"gs"}.

Note that Ghostscript may do font substitution, so the font embedded
may differ from that specified in the original file.
\end{Details}
%
\begin{Value}
The shell command used to invoke Ghostscript is returned
invisibly. This may be useful for debugging purposes as
you can run the command by hand in a shell to look for problems.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscriptFonts}{postscriptFonts}},
\code{\LinkA{Devices}{Devices}}.

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{extendrange}{Extend a Numerical Range by a Small Percentage}{extendrange}
\keyword{dplot}{extendrange}
%
\begin{Description}\relax
Extends a numerical range by a small percentage, i.e., fraction,
\emph{on both sides}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
extendrange(x, r = range(x, na.rm = TRUE), f = 0.05)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] numeric vector; not used if \code{r} is specified.
\item[\code{r}] numeric vector of length 2; defaults to the
\code{\LinkA{range}{range}} of \code{x}.
\item[\code{f}] number specifying the fraction by which the range should be
extended.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A numeric vector of length 2, \code{r + c(-f,f) * diff(r)}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{range}{range}}; \code{\LinkA{pretty}{pretty}} which can be
considered a sophisticated extension of \code{extendrange}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- 1:5
(r <- range(x))         # 1    5
extendrange(x)          # 0.8  5.2
extendrange(x, f= 0.01) # 0.96 5.04
## Use 'r' if you have it already:
stopifnot(identical(extendrange(r=r),
                    extendrange(x)))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{getGraphicsEvent}{Wait for a mouse or keyboard event from a graphics window}{getGraphicsEvent}
\keyword{iplot}{getGraphicsEvent}
%
\begin{Description}\relax
This function waits for input from a graphics window in the
form of a mouse or keyboard event.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
getGraphicsEvent(prompt = "Waiting for input", 
                 onMouseDown = NULL, onMouseMove = NULL,
                 onMouseUp = NULL, onKeybd = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{prompt}] prompt to be displayed to the user
\item[\code{onMouseDown}] a function to respond to mouse clicks
\item[\code{onMouseMove}] a function to respond to mouse movement
\item[\code{onMouseUp}] a function to respond to mouse button releases
\item[\code{onKeybd}] a function to respond to key presses
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This function allows user input from some graphics devices (currently
only the Windows screen display).  When called, event handlers may be 
installed to respond to events involving the mouse or keyboard.  

The mouse event handlers should be functions with header 
\code{function(buttons, x, y)}.  The coordinates \code{x}
and \code{y} will be passed to mouse event handlers in device independent
coordinates (i.e. the lower left corner of the window is \code{(0,0)}, 
the upper right is \code{(1,1)}).  The \code{buttons} argument 
will be a vector listing the buttons
that are pressed at the time of the event, with 0 for left, 1 for middle, and 2 
for right.

The keyboard event handler should be a function with header
\code{function(key)}.  A single element character vector will be passed
to this handler, corresponding to the key press.  Shift and other modifier
keys will have been processed, so \code{shift-a} will be passed as
\code{"A"}.  The following special keys may also be passed to the handler:
\begin{itemize}

\item Control keys, passed as \code{"Ctrl-A"}, etc.
\item Navigation keys, passed as one of \code{"Left", "Up", "Right", "Down",
     "PgUp", "PgDn", "End", "Home"}
\item Edit keys, passed as one of \code{"Ins", "Del"}
\item Function keys, passed as one of \code{"F1", "F2", ...}

\end{itemize}


The event handlers are standard R functions, and will be executed in
an environment as though they had been called directly from \code{getGraphicsEvent}.

Events will be processed until
\begin{itemize}

\item one of the event handlers returns
a non-\code{NULL} value which will be returned as the value of
\code{getGraphicsEvent}, or 
\item the user interrupts the function from the
console.

\end{itemize}

\end{Details}
%
\begin{Value}
A non-\code{NULL} value returned from one of the event handlers.
\end{Value}
%
\begin{Author}\relax
Duncan Murdoch
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
    mousedown <- function(buttons, x, y) {
        plx <- grconvertX(x, "ndc", "user")
        ply <- grconvertY(y, "ndc", "user")    
        cat("Buttons ", paste(buttons, collapse=" "), " at ndc",
            x, y, "user", plx, ply, "\n")
        points(plx, ply, col="red", pch=19, cex=2)
        if (x > 0.85 && y > 0.85) "Done"
        else NULL
    }
    
    mousemove <- function(buttons, x, y) {
        plx <- grconvertX(x, "ndc", "user")
        ply <- grconvertY(y, "ndc", "user")    
        points(plx, ply)
        NULL
    }
    
    keybd <- function(key) {
        cat("Key <", key, ">\n", sep = "")
    }
    
    plot(0:1, 0:1, type='n')
    getGraphicsEvent("Click on upper right to quit",
                     onMouseDown = mousedown,
                     onMouseMove = mousemove,
                     onKeybd = keybd)

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{gray}{Gray Level Specification}{gray}
\aliasA{grey}{gray}{grey}
\keyword{color}{gray}
%
\begin{Description}\relax
Create a vector of colors from a vector of gray levels.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
gray(level)
grey(level)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{level}] a vector of desired gray levels between \code{0} and
\code{1}; zero indicates \code{"black"} and one indicates
\code{"white"}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The values returned by \code{gray} can be used with a \code{col=}
specification in graphics functions or in \code{\LinkA{par}{par}}.

\code{grey} is an alias for \code{gray}.
\end{Details}
%
\begin{Value}
A vector of colors of the same length as \code{level}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{hsv}{hsv}},
\code{\LinkA{hcl}{hcl}},
\code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
gray(0:8 / 8)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{gray.colors}{Gray Color Palette}{gray.colors}
\aliasA{grey.colors}{gray.colors}{grey.colors}
\keyword{color}{gray.colors}
%
\begin{Description}\relax
Create a vector of \code{n} gamma-corrected gray colors.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
gray.colors(n, start = 0.3, end = 0.9, gamma = 2.2)
grey.colors(n, start = 0.3, end = 0.9, gamma = 2.2)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{n}] the number of gray colors (\eqn{\ge 1}{}) to be in the
palette.
\item[\code{start}] starting gray level in the palette (should be between
\code{0} and \code{1} where zero indicates \code{"black"} and one
indicates \code{"white"}).
\item[\code{end}] ending gray level in the palette.
\item[\code{gamma}] the gamma correction.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The function \code{gray.colors} chooses a series of \code{n}
gamma-corrected gray levels between \code{start} and \code{end}:
\eqn{(\mathit{start}^\gamma, \dots,
    \mathit{end}^\gamma)^(1/\gamma)}{}.
The returned palette contains the corresponding gray colors.
This palette is used in \code{\LinkA{barplot.default}{barplot.default}}.

\code{grey.colors} is an alias for \code{gray.colors}.
\end{Details}
%
\begin{Value}
A vector of \code{n} gray colors.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{gray}{gray}},
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{palette}{palette}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

pie(rep(1,12), col = gray.colors(12))
barplot(1:12, col = gray.colors(12))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{hcl}{HCL Color Specification}{hcl}
\keyword{color}{hcl}
\keyword{dplot}{hcl}
%
\begin{Description}\relax
Create a vector of colors from vectors specifying hue,
chroma and luminance.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
hcl(h = 0, c = 35, l = 85, alpha, fixup = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{h}] The hue of the color specified as an angle in the range
[0,360].  0 yields red, 120 yields green 240 yields blue, etc.
\item[\code{c}] The chroma of the color.  The upper bound for chroma depends
on hue and luminance.
\item[\code{l}] A value in the range [0,100] giving the luminance of the
colour.  For a given combination of hue and chroma, only
a subset of this range is possible.
\item[\code{alpha}] numeric vector of values in the range \code{[0,1]} for
alpha transparency channel (0 means transparent and 1 means opaque).
\item[\code{fixup}] a logical value which indicates whether the resulting
RGB values should be corrected to ensure that a real color results.
if \code{fixup} is \code{FALSE} RGB components lying outside the
range [0,1] will result in an \code{NA} value.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This function corresponds to polar coordinates in the CIE-LUV
color space. Steps of equal size in this space correspond to
approximately equal perceptual changes in color.  Thus, \code{hcl}
can be thought of as a perceptually based version of \code{\LinkA{hsv}{hsv}}.

The function is primarily intended as a way of computing
colors for filling areas in plots where area corresponds to a
numerical value (pie charts, bar charts, mosaic plots, histograms,
etc).  Choosing colors which have equal chroma and luminance
provides a way of minimising the irradiation illusion which
would otherwise produce a misleading impression of how large
the areas are.

The default values of chroma and luminance make it possible
to generate a full range of hues and have a relatively pleasant
pastel appearance.

The RGB values produced by this function correspond to the sRGB
color space used on most PC computer displays.  There are other
packages which provide more general color space facilities.

Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: see \code{\LinkA{rgb}{rgb}}.
\end{Details}
%
\begin{Value}
A vector of character strings which can be used as color
specifications by R graphics functions.
\end{Value}
%
\begin{Note}\relax
At present there is no guarantee that the colours rendered by R
graphics devices will correspond to their sRGB description.
It is planned to adopt sRGB as the standard R color description
in future.
\end{Note}
%
\begin{Author}\relax
Ross Ihaka
\end{Author}
%
\begin{References}\relax
Ihaka, R. (2003).
Colour for Presentation Graphics, Proceedings of the 3rd International
Workshop on Distributed Statistical Computing (DSC 2003), March 20-22,
2003, Technische Universitt Wien, Vienna, Austria.
\url{http://www.ci.tuwien.ac.at/Conferences/DSC-2003}.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{hsv}{hsv}},
\code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

# The Foley and Van Dam PhD Data.
csd <- matrix(c( 4,2,4,6, 4,3,1,4, 4,7,7,1,
                 0,7,3,2, 4,5,3,2, 5,4,2,2,
                 3,1,3,0, 4,4,6,7, 1,10,8,7,
                 1,5,3,2, 1,5,2,1, 4,1,4,3,
                 0,3,0,6, 2,1,5,5), nrow=4)

csphd <- function(colors)
  barplot(csd, col = colors, ylim = c(0,30),
          names = 72:85, xlab = "Year", ylab = "Students",
          legend = c("Winter", "Spring", "Summer", "Fall"),
          main = "Computer Science PhD Graduates", las = 1)

# The Original (Metaphorical) Colors (Ouch!)
csphd(c("blue", "green", "yellow", "orange"))

# A Color Tetrad (Maximal Color Differences)
csphd(hcl(h = c(30, 120, 210, 300)))

# Same, but lighter and less colorful
# Turn of automatic correction to make sure
# that we have defined real colors.
csphd(hcl(h = c(30, 120, 210, 300),
          c = 20, l = 90, fixup = FALSE))

# Analogous Colors
# Good for those with red/green color confusion
csphd(hcl(h = seq(60, 240, by = 60)))

# Metaphorical Colors
csphd(hcl(h = seq(210, 60, length = 4)))

# Cool Colors
csphd(hcl(h = seq(120, 0, length = 4) + 150))

# Warm Colors
csphd(hcl(h = seq(120, 0, length = 4) - 30))

# Single Color
hist(stats::rnorm(1000), col = hcl(240))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{Hershey}{Hershey Vector Fonts in R}{Hershey}
\keyword{aplot}{Hershey}
%
\begin{Description}\relax
If the \code{family} graphical parameter (see \code{\LinkA{par}{par}})
has been set to one of the Hershey fonts (see `Details')
Hershey vector fonts are used to render text.

When using the \code{\LinkA{text}{text}} and \code{\LinkA{contour}{contour}} functions
Hershey fonts may be selected via the \code{vfont} argument, which is
a character vector of length 2 (see `Details' for valid
values).  This allows Cyrillic to be selected, which is not available
via the font families.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
Hershey
\end{verbatim}
\end{Usage}
%
\begin{Details}\relax
The Hershey fonts have two advantages:\\{}
\begin{enumerate}

\item vector fonts describe each
character in terms of a set of points;  \R{} renders the character by
joining up the points with straight lines.  This intimate knowledge of
the outline of each character means that \R{} can arbitrarily transform
the characters, which can mean that the vector fonts look better
for rotated text.
\item this implementation was adapted from the GNU libplot library
which provides support for non-ASCII and non-English fonts.  This means
that it is possible, for example, to produce weird plotting symbols and
Japanese characters.

\end{enumerate}

Drawback:\\{}
You cannot use mathematical expressions (\code{\LinkA{plotmath}{plotmath}}) with
Hershey fonts.

The Hershey characters are organised into a set of fonts.  A
particular font is selected by specifying one of the following
font families via \code{par(family)} and specifying the desired font
face (plain, bold, italic, bold-italic) via \code{par(font)}.



\Tabular{ll}{
family & faces available \\{}
\code{"HersheySerif"} & plain, bold, italic, bold-italic \\{}
\code{"HersheySans"} & plain, bold, italic, bold-italic \\{}
\code{"HersheyScript"} & plain, bold \\{}
\code{"HersheyGothicEnglish"} & plain \\{}
\code{"HersheyGothicGerman"} & plain \\{}
\code{"HersheyGothicItalian"} & plain \\{}
\code{"HersheySymbol"} & plain, bold, italic, bold-italic \\{}
\code{"HersheySansSymbol"} & plain, italic \\{}
}

In the \code{vfont} specification for the \code{text} and
\code{contour} functions, the Hershey font is specified by a typeface
(e.g., \code{serif} or \code{sans serif}) and a fontindex or
`style' (e.g., \code{plain} or \code{italic}). The first
element of \code{vfont} specifies the typeface and the second element
specifies the fontindex.  The first table produced by
\code{demo(Hershey)} shows the character \code{a} produced by each of
the different fonts.

The available \code{typeface} and \code{fontindex} values are
available as list components of the variable \code{Hershey}.
The allowed pairs for \code{(typeface, fontindex)} are:




\Tabular{ll}{
serif & plain \\{}
serif & italic \\{}
serif & bold \\{}
serif & bold italic \\{}
serif & cyrillic \\{}
serif & oblique cyrillic \\{}
serif & EUC \\{}
sans serif & plain \\{}
sans serif & italic \\{}
sans serif & bold \\{}
sans serif & bold italic \\{}
script & plain \\{}
script & italic \\{}
script & bold \\{}
gothic english & plain \\{}
gothic german & plain \\{}
gothic italian & plain \\{}
serif symbol & plain \\{}
serif symbol & italic \\{}
serif symbol & bold \\{}
serif symbol & bold italic \\{}
sans serif symbol & plain \\{}
sans serif symbol & italic \\{}
}
and the indices of these are available as \code{Hershey\$allowed}.

\begin{description}

\item[Escape sequences:] The string to be drawn can include escape
sequences, which all begin with a \samp{\bsl{}}.   When \R{} encounters a
\samp{\bsl{}}, rather than drawing the \samp{\bsl{}}, it treats the
subsequent character(s) as a coded description of what to draw.

One useful escape sequence (in the current context) is of the
form: \samp{\bsl{}123}.  The three digits following the \samp{\bsl{}}
specify an octal code for a character.  For example, the octal
code for \code{p} is 160 so the strings \code{"p"} and
\code{"\bsl{}160"} are equivalent. This is useful for producing
characters when there is not an appropriate key on your keyboard.

The other useful escape sequences all begin with \samp{\bsl{}\bsl{}}.
These are described below.  Remember that backslashes have to be
doubled in \R{} character strings, so they need to be entered with
\emph{four} backslashes.


\item[Symbols:] an entire string of Greek symbols can be produced by
selecting the HersheySymbol or HersheySansSymbol family or the
Serif Symbol or Sans Serif Symbol typeface.  To allow Greek
symbols to be embedded in a string which uses a non-symbol
typeface, there are a set of symbol escape sequences of the form
\samp{\bsl{}\bsl{}ab}. For example, the escape sequence \samp{\bsl{}\bsl{}*a}
produces a Greek alpha.  The second table in \code{demo(Hershey)}
shows all of the symbol escape sequences and the symbols that they
produce.


\item[ISO Latin-1:] further escape sequences of the form
\samp{\bsl{}\bsl{}ab} are provided for producing ISO Latin-1 characters.
Another option is to use the appropriate octal code.  The
(non-ASCII) ISO Latin-1 characters are in the range 241\dots377.
For example, \samp{\bsl{}366} produces the character o with an umlaut.
The third table in \code{demo(Hershey)} shows all of the ISO
Latin-1 escape sequences.

These characters can be used directly in a Latin-1 locale or on
a system with MBCS support.  (In the latter, characters not in
Latin-1 are replaced by a dot.)

Several characters are missing, c-cedilla has no cedilla and
`sharp s' (\samp{U+00DF}, also known as `esszett')
is rendered as \code{ss}.


\item[Special Characters:] a set of characters are provided which
do not fall into any standard font.  These can only be accessed by
escape sequence.  For example, \samp{\bsl{}\bsl{}LI} produces the zodiac sign for
Libra, and \samp{\bsl{}\bsl{}JU} produces the astronomical sign for Jupiter.
The fourth table in \code{demo(Hershey)} shows all of the
special character escape sequences.


\item[Cyrillic Characters:] cyrillic characters are implemented
according to the K018-R encoding, and can be used directly in such
a locale using the Serif typeface and Cyrillic (or Oblique Cyrillic)
fontindex.  Alternatively they can be specified via an octal code
in the range 300 to 337 for lower case characters or 340 to 377 for
upper case characters.  The fifth table in \code{demo(Hershey)} shows the
octal codes for the available Cyrillic characters.

Cyrillic has to be selected via a \code{("serif", fontindex)} pair
rather than via a font family.


\item[Japanese Characters:] 83 Hiragana, 86 Katakana, and 603 Kanji
characters are implemented according to the EUC-JP (Extended Unix Code)
encoding. Each character is identified by a unique hexadecimal code.
The Hiragana characters
are in the range 0x2421 to 0x2473, Katakana are in the range 0x2521 to
0x2576, and Kanji are (scattered about) in the range 0x3021 to 0x6d55.

When using the Serif typeface and EUC
fontindex, these characters can be produced by a \emph{pair} of octal
codes.  Given the hexadecimal code (e.g., 0x2421), take the first two
digits and add 0x80 and do the same to the second two digits (e.g.,
0x21 and 0x24 become 0xa4 and 0xa1), then convert both to octal (e.g.,
0xa4 and 0xa1 become 244 and 241).  For example, the first Hiragana
character is produced by \samp{\bsl{}244\bsl{}241}.

It is also possible to use the hexadecimal code directly.  This works
for all non-EUC fonts by specifying an escape sequence of the form
\samp{\bsl{}\#J1234}.  For example, the first Hiragana character is produced
by \samp{\bsl{}\#J2421}.

The Kanji characters may be specified in a third way, using the
so-called "Nelson Index", by specifying an escape sequence of the form
\samp{\bsl{}\#N1234}.  For example, the (obsolete) Kanji for `one' is
produced by \samp{\bsl{}\#N0001}.

\code{demo(Japanese)} shows the available Japanese characters.


\item[Raw Hershey Glyphs:] all of the characters in the Hershey
fonts are stored in a large array.  Some characters are not
accessible in any of the Hershey fonts.  These characters can only
be accessed via an escape sequence of the form \samp{\bsl{}\#H1234}.
For example, the fleur-de-lys is produced by \samp{\bsl{}\#H0746}.
The sixth and seventh tables of \code{demo(Hershey)} shows all of
the available raw glyphs.  
\end{description}
 
\end{Details}
%
\begin{References}\relax
\url{http://www.gnu.org/software/plotutils/plotutils.html} 
\end{References}
%
\begin{SeeAlso}\relax
 \code{\LinkA{demo}{demo}(Hershey)}, \code{\LinkA{par}{par}},
\code{\LinkA{text}{text}}, \code{\LinkA{contour}{contour}}.

\code{\LinkA{Japanese}{Japanese}} for the Japanese characters in the Hershey fonts.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
Hershey

## for tables of examples, see demo(Hershey)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{hsv}{HSV Color Specification}{hsv}
\keyword{color}{hsv}
\keyword{dplot}{hsv}
%
\begin{Description}\relax
Create a vector of colors from vectors specifying hue, saturation and
value.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
hsv(h = 1, s = 1, v = 1, gamma = 1, alpha)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{h,s,v}] numeric vectors of values in the range \code{[0,1]} for
`hue', `saturation' and `value' to be combined
to form a vector of colors.  Values in shorter arguments are
recycled.
\item[\code{gamma}] a gamma-correction exponent, \eqn{\gamma}{}
\item[\code{alpha}] numeric vector of values in the range \code{[0,1]} for
alpha transparency channel (0 means transparent and 1 means opaque).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: see \code{\LinkA{rgb}{rgb}}.
\end{Details}
%
\begin{Value}
This function creates a vector of colors corresponding to the
given values in HSV space.  The values returned by \code{hsv} can be
used with a \code{col=} specification in graphics functions or in
\code{par}.
\end{Value}
%
\begin{Section}{Gamma correction}
For each color, \eqn{(r,g,b)}{} in RGB space (with all values in \eqn{[0,1]}{}),
the final color corresponds to
\eqn{(r^{\gamma}, g^{\gamma}, b^{\gamma})}{}.
\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{hcl}{hcl}} for a perceptually based version of \code{hsv()},
\code{\LinkA{rgb}{rgb}} and \code{\LinkA{rgb2hsv}{rgb2hsv}} for RGB to HSV conversion;
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{gray}{gray}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

hsv(.5,.5,.5)

## Look at gamma effect:
n <- 20;  y <- -sin(3*pi*((1:n)-1/2)/n)
op <- par(mfrow=c(3,2),mar=rep(1.5,4))
for(gamma in c(.4, .6, .8, 1, 1.2, 1.5))
  plot(y, axes = FALSE, frame.plot = TRUE,
       xlab = "", ylab = "", pch = 21, cex = 30,
       bg = rainbow(n, start=.85, end=.1, gamma = gamma),
       main = paste("Red tones;  gamma=",format(gamma)))
par(op)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{Japanese}{Japanese characters in R}{Japanese}
\keyword{aplot}{Japanese}
%
\begin{Description}\relax
The implementation of Hershey vector fonts provides a large number of
Japanese characters (Hiragana, Katakana, and Kanji).
\end{Description}
%
\begin{Details}\relax
Without keyboard support for typing Japanese characters, the only way
to produce these characters is to use special escape sequences: see
\code{\LinkA{Hershey}{Hershey}}.

For example, the Hiragana character for the sound "ka" is produced
by \samp{\bsl{}\#J242b} and the Katakana character for this sound is
produced by \samp{\bsl{}\#J252b}.  The Kanji ideograph for "one" is
produced by \samp{\bsl{}\#J306c} or \samp{\bsl{}\#N0001}.

The output from \code{\LinkA{demo}{demo}(Japanese)} shows tables of the escape
sequences for the available Japanese characters.
\end{Details}
%
\begin{References}\relax
\url{http://www.gnu.org/software/plotutils/plotutils.html}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{demo}{demo}(Japanese)}, \code{\LinkA{Hershey}{Hershey}}, \code{\LinkA{text}{text}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

plot(1:9, type="n", axes=FALSE, frame=TRUE, ylab="",
     main= "example(Japanese)", xlab= "using Hershey fonts")
par(cex=3)
Vf <- c("serif", "plain")

text(4, 2, "\#J2438\#J2421\#J2451\#J2473", vfont = Vf)
text(4, 4, "\#J2538\#J2521\#J2551\#J2573", vfont = Vf)
text(4, 6, "\#J467c\#J4b5c", vfont = Vf)
text(4, 8, "Japan", vfont = Vf)
par(cex=1)
text(8, 2, "Hiragana")
text(8, 4, "Katakana")
text(8, 6, "Kanji")
text(8, 8, "English")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{make.rgb}{Create colour spaces}{make.rgb}
\aliasA{colorConverter}{make.rgb}{colorConverter}
\keyword{color}{make.rgb}
%
\begin{Description}\relax
These functions specify colour spaces for use in
\code{\LinkA{convertColor}{convertColor}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
make.rgb(red, green, blue, name = NULL, white = "D65",
         gamma = 2.2)

colorConverter(toXYZ, fromXYZ, name, white=NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{red,green,blue}] Chromaticity (xy or xyY) of RGB primaries
\item[\code{name}] Name for the colour space
\item[\code{white}] Character string specifying the reference white (see
`Details'.)
\item[\code{gamma}] Display gamma (nonlinearity). A positive number or the
string \code{"sRGB"} 
\item[\code{fromXYZ}] Function to convert from XYZ tristimulus coordinates
to this space
\item[\code{toXYZ}] Function to convert from this space to XYZ tristimulus
coordinates.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An RGB colour space is defined by the chromaticities of the  red, green and
blue primaries.  These are given as vectors of length 2 or 3 in xyY
coordinates (the Y component is not used and may be omitted).
The chromaticities are defined relative to a reference white, which
must be one of the CIE standard illuminants: "A", "B", "C",
"D50", "D55", "D60", "E" (usually "D65").

The display gamma is most commonly 2.2, though 1.8 is used for Apple RGB.
The sRGB standard specifies a more complicated function that is close
to a gamma of 2.2; \code{gamma="sRGB"} uses this function.

Colour spaces other than RGB can be specified directly by giving
conversions to and from XYZ tristimulus coordinates.
The functions  should take two arguments. The first is a vector giving the
coordinates for one colour. The second argument is the reference
white. If a specific reference white is included in the definition of
the colour space (as for the RGB spaces) this second argument should
be ignored and may be \code{...}.
\end{Details}
%
\begin{Value}
An object of class \code{colorConverter}
\end{Value}
%
\begin{References}\relax
Conversion algorithms from \url{http://www.brucelindbloom.com}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{convertColor}{convertColor}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
(pal <- make.rgb(red=  c(0.6400,0.3300),
                 green=c(0.2900,0.6000),
                 blue= c(0.1500,0.0600),
                 name = "PAL/SECAM RGB"))

## converter for sRGB in #rrggbb format
hexcolor <- colorConverter(toXYZ = function(hex,...) {
                            rgb <- t(col2rgb(hex))/255
                            colorspaces$sRGB$toXYZ(rgb,...) },
                           fromXYZ = function(xyz,...) {
                              rgb <- colorspaces$sRGB$fromXYZ(xyz,..)
                              rgb <- round(rgb,5)
                              if (min(rgb) < 0 || max(rgb) > 1)
                                   as.character(NA)
                              else
                                   rgb(rgb[1],rgb[2],rgb[3])},
                           white = "D65", name = "#rrggbb")

(cols <- t(col2rgb(palette())))
(luv <- convertColor(cols,from="sRGB", to="Luv", scale.in=255))
(hex <- convertColor(luv, from="Luv",  to=hexcolor, scale.out=NULL))

## must make hex a matrix before using it
(cc <- round(convertColor(as.matrix(hex), from= hexcolor, to= "sRGB",
                          scale.in=NULL, scale.out=255)))
stopifnot(cc == cols)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{n2mfrow}{Compute Default mfrow From Number of Plots}{n2mfrow}
\keyword{dplot}{n2mfrow}
\keyword{utilities}{n2mfrow}
%
\begin{Description}\relax
Easy setup for plotting multiple figures (in a rectangular layout) on
one page.  This computes a sensible default for
\code{\LinkA{par}{par}(mfrow)}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
n2mfrow(nr.plots)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{nr.plots}] integer; the number of plot figures you'll want to draw.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A length two integer vector \code{nr, nc} giving the number of rows
and columns, fulfilling \code{nr >= nc >= 1} and \code{nr * nc >= nr.plots}.
\end{Value}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{par}{par}}, \code{\LinkA{layout}{layout}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

n2mfrow(8) # 3 x 3

n <- 5 ; x <- seq(-2,2, len=51)
## suppose now that 'n' is not known {inside function}
op <- par(mfrow = n2mfrow(n))
for (j in 1:n)
   plot(x, x^j, main = substitute(x^ exp, list(exp = j)), type = "l",
   col = "blue")

sapply(1:10, n2mfrow)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{nclass}{Compute the Number of Classes for a Histogram}{nclass}
\methaliasA{nclass.FD}{nclass}{nclass.FD}
\methaliasA{nclass.scott}{nclass}{nclass.scott}
\methaliasA{nclass.Sturges}{nclass}{nclass.Sturges}
\keyword{univar}{nclass}
%
\begin{Description}\relax
Compute the number of classes for a histogram.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
nclass.Sturges(x)
nclass.scott(x)
nclass.FD(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] 
A data vector.

\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{nclass.Sturges} uses Sturges' formula, implicitly basing bin
sizes on the range of the data.

\code{nclass.scott} uses Scott's choice for a normal distribution based on
the estimate of the standard error, unless that is zero where it
returns \code{1}.

\code{nclass.FD} uses the Freedman-Diaconis choice based on the
inter-quartile range (\code{\LinkA{IQR}{IQR}}) unless that's zero where it
reverts to \code{\LinkA{mad}{mad}(x, constant=2)} and when that is \eqn{0}{}
as well, returns \code{1}.
\end{Details}
%
\begin{Value}
The suggested number of classes.
\end{Value}
%
\begin{References}\relax
Venables, W. N. and Ripley, B. D. (2002)
\emph{Modern Applied Statistics with S-PLUS.}
Springer, page 112.

Freedman, D. and Diaconis, P. (1981)
On the histogram as a density estimator: \eqn{L_2}{} theory.
\emph{Zeitschrift fr Wahrscheinlichkeitstheorie
und verwandte Gebiete} \bold{57}, 453--476.

Scott, D. W. (1979) On optimal and data-based histograms.
\emph{Biometrika} \bold{66}, 605--610.

Scott, D. W. (1992)
\emph{Multivariate Density Estimation. Theory, Practice, and
Visualization}. Wiley.

Sturges, H. A. (1926)  The choice of a class interval.
\emph{Journal of the American Statistical Association} \bold{21}, 65--66.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{hist}{hist}} and \code{\LinkA{truehist}{truehist}} (package
\pkg{MASS});  \code{\LinkA{dpih}{dpih}} (package
\pkg{KernSmooth}) for a plugin bandwidth proposed by Wand(1995).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
set.seed(1)
x <- stats::rnorm(1111)
nclass.Sturges(x)

## Compare them:
NC <- function(x) c(Sturges = nclass.Sturges(x),
      Scott = nclass.scott(x), FD = nclass.FD(x))
NC(x)
onePt <- rep(1, 11)
NC(onePt) # no longer gives NaN
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{palette}{Set or View the Graphics Palette}{palette}
\keyword{color}{palette}
\keyword{sysdata}{palette}
%
\begin{Description}\relax
View or manipulate the color palette which is used when a \code{col=}
has a numeric index.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
palette(value)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{value}] an optional character vector.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If \code{value} has length 1, it is taken to be the name of
a built in color palette.  If \code{value} has length greater
than 1 it is assumed to contain a description of the colors
which are to make up the new palette (either by name or
by RGB levels).

If \code{value} is omitted or has length 0, no change is made
the current palette.

Currently, the only built-in palette is \code{"default"}.
\end{Details}
%
\begin{Value}
The palette which \emph{was} in effect.  This is \code{\LinkA{invisible}{invisible}}
unless the argument is omitted.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{colors}{colors}} for the vector of built-in named colors;
\code{\LinkA{hsv}{hsv}}, \code{\LinkA{gray}{gray}}, \code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{terrain.colors}{terrain.colors}},\dots to construct colors.

\code{\LinkA{colorRamp}{colorRamp}} to interpolate colors, making custom palettes;
\code{\LinkA{col2rgb}{col2rgb}} for translating colors to RGB 3-vectors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

palette()               # obtain the current palette
palette(rainbow(6))     # six color rainbow

(palette(gray(seq(0,.9,len=25)))) # gray scales; print old palette
matplot(outer(1:100,1:30), type='l', lty=1,lwd=2, col=1:30,
        main = "Gray Scales Palette",
        sub = "palette(gray(seq(0,.9,len=25)))")
palette("default")      # reset back to the default

## on a device where alpha-transparency is supported,
##  use 'alpha = 0.3' transparency with the default palette :
opal <- col2rgb(palette(), alpha=TRUE)/255; opal["alpha",] <- 0.3
mycols <- do.call(rgb, as.list(as.data.frame(t(opal))))
opal <- palette(mycols)
x <- rnorm(1000); xy <- cbind(x, 3*x + rnorm(1000))
plot (xy, lwd=2,
       main = "Alpha-Transparency Palette\n alpha = 0.3")
xy[,1] <- -xy[,1]
points(xy, col=8, pch=16, cex = 1.5)
palette("default")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{Palettes}{Color Palettes}{Palettes}
\aliasA{cm.colors}{Palettes}{cm.colors}
\aliasA{heat.colors}{Palettes}{heat.colors}
\aliasA{rainbow}{Palettes}{rainbow}
\aliasA{terrain.colors}{Palettes}{terrain.colors}
\aliasA{topo.colors}{Palettes}{topo.colors}
\keyword{color}{Palettes}
\keyword{dplot}{Palettes}
%
\begin{Description}\relax
Create a vector of \code{n} contiguous colors.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rainbow(n, s = 1, v = 1, start = 0, end = max(1,n - 1)/n,
        gamma = 1, alpha = 1)
heat.colors(n, alpha = 1)
terrain.colors(n, alpha = 1)
topo.colors(n, alpha = 1)
cm.colors(n, alpha = 1)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{n}] the number of colors (\eqn{\ge 1}{}) to be in the
palette.
\item[\code{s,v}] the `saturation' and `value' to be used
to complete the HSV color descriptions.
\item[\code{start}] the (corrected) hue in [0,1] at which the rainbow
begins.
\item[\code{end}] the (corrected) hue in [0,1] at which the rainbow ends.
\item[\code{gamma}] the gamma correction, see argument \code{gamma} in
\code{\LinkA{hsv}{hsv}}.
\item[\code{alpha}] the alpha transparency, a number in [0,1], see argument
\code{alpha} in \code{\LinkA{hsv}{hsv}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Conceptually, all of these functions actually use (parts of) a line
cut out of the 3-dimensional color space, parametrized by
\code{\LinkA{hsv}{hsv}(h,s,v, gamma)}, where \code{gamma}\eqn{=1}{} for the
\emph{foo}\code{.colors} function, and hence,
equispaced hues in RGB space tend to cluster at
the red, green and blue primaries.

Some applications such as contouring require a palette
of colors which do not wrap around to give a final
color close to the starting one.

With \code{rainbow}, the parameters \code{start} and \code{end} can be used
to specify particular subranges of hues.
The following values can be used when generating such a subrange:
red=0, yellow=\eqn{\frac 1 6}{}, green=\eqn{\frac 2 6}{},
cyan=\eqn{\frac 3 6}{}, blue=\eqn{\frac 4 6}{}
and magenta=\eqn{\frac 5 6}{}.
\end{Details}
%
\begin{Value}
A character vector, \code{cv}, of color names.  This can be used
either to create a user--defined color palette for subsequent
graphics by \code{\LinkA{palette}{palette}(cv)}, a \code{col=} specification
in graphics functions or in \code{par}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{colors}{colors}}, \code{\LinkA{palette}{palette}}, \code{\LinkA{hsv}{hsv}},
\code{\LinkA{hcl}{hcl}}, \code{\LinkA{rgb}{rgb}}, \code{\LinkA{gray}{gray}} and
\code{\LinkA{col2rgb}{col2rgb}} for translating to RGB numbers.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)
# A Color Wheel
pie(rep(1,12), col=rainbow(12))

##------ Some palettes ------------
demo.pal <-
  function(n, border = if (n<32) "light gray" else NA,
           main = paste("color palettes;  n=",n),
           ch.col = c("rainbow(n, start=.7, end=.1)", "heat.colors(n)",
                      "terrain.colors(n)", "topo.colors(n)",
                      "cm.colors(n)"))
{
    nt <- length(ch.col)
    i <- 1:n; j <- n / nt; d <- j/6; dy <- 2*d
    plot(i,i+d, type="n", yaxt="n", ylab="", main=main)
    for (k in 1:nt) {
        rect(i-.5, (k-1)*j+ dy, i+.4, k*j,
             col = eval(parse(text=ch.col[k])), border = border)
        text(2*j,  k * j +dy/4, ch.col[k])
    }
}
n <- if(.Device == "postscript") 64 else 16
     # Since for screen, larger n may give color allocation problem
demo.pal(n)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{pdf}{PDF Graphics Device}{pdf}
\keyword{device}{pdf}
%
\begin{Description}\relax
\code{pdf} starts the graphics device driver for producing PDF
graphics.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pdf(file = ifelse(onefile, "Rplots.pdf", "Rplot%03d.pdf"),
    width, height, onefile, family, title, fonts, version,
    paper, encoding, bg, fg, pointsize, pagecentre, colormodel,
    useDingbats, useKerning, fillOddEven)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.
For use with \code{onefile=FALSE} give a C integer format such
as \code{"Rplot\%03d.pdf"} (the default in that case).
(See \code{\LinkA{postscript}{postscript}} for further details.)

\item[\code{width, height}] the width and height of the graphics region in
inches.  The default values are \code{7}.
\item[\code{onefile}] logical: if true (the default) allow multiple figures
in one file.  If false, generate a file with name containing the page
number for each page.  Defaults to \code{TRUE}.
\item[\code{family}] the font family to be used, see
\code{\LinkA{postscript}{postscript}}.  Defaults to \code{"Helvetica"}.
\item[\code{title}] title string to embed as the \samp{/Title} field in the
file.  Defaults to \code{"R Graphics Output"}.
\item[\code{fonts}] a character vector specifying \R{} graphics font family
names for fonts which will be included in the PDF file.  Defaults to
\code{NULL}.
\item[\code{version}] a string describing the PDF version that will be
required to view the output.  This is a minimum, and will be
increased (with a warning) if necessary.  Defaults to \code{"1.4"},
but see `Details'.
\item[\code{paper}] the target paper size.  The choices are
\code{"a4"}, \code{"letter"}, \code{"legal"} (or \code{"us"}) and
\code{"executive"} (and these can be capitalized), or \code{"a4r"}
and \code{"USr"} for rotated (`landscape').
The default is \code{"special"}, which means that the \code{width}
and \code{height} specify the paper size.  A further choice is
\code{"default"}; if this is selected, the
papersize is taken from the option \code{"papersize"}
if that is set and as \code{"a4"} if it is unset or empty.
Defaults \code{"special"}.

\item[\code{encoding}] the name of an encoding file.  See
\code{\LinkA{postscript}{postscript}} for details.  Defaults to \code{"default"}.
\item[\code{bg}] the initial background color to be used.  Defaults to
\code{"transparent"}.
\item[\code{fg}] the initial foreground color to be used.  Defaults to
\code{"black"}.
\item[\code{pointsize}] the default point size to be used.  Strictly
speaking, in bp, that is 1/72 of an inch, but approximately in
points.  Defaults to \code{12}.
\item[\code{pagecentre}] logical: should the device region be centred on the
page? -- is only relevant for \code{paper != "special"}.  Defaults
to true.
\item[\code{colormodel}] a character string describing the color model:
currently allowed values are \code{"rgb"}, \code{"gray"} and
\code{"cmyk"}.  Defaults to \code{"rgb"}.
\item[\code{useDingbats}] logical.  Should small circles be rendered
\emph{via} the Dingbats font?  Defaults to \code{TRUE}, which produces
smaller and better output. Setting this to \code{FALSE} can work
around font display problems in broken PDF viewers.
See the `Note' for a possible fix for such viewers.

\item[\code{useKerning}] logical.  Should kerning corrections be included in
setting text and calculating string widths?  Defaults to \code{TRUE}.
\item[\code{fillOddEven}] logical controlling the polygon fill mode:  see
\code{\LinkA{polygon}{polygon}} for details.  Default \code{FALSE}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
All arguments except \code{file} default to values given by
\code{\LinkA{pdf.options}{pdf.options}()}.  The ultimate defaults are quoted in the
arguments section.

\code{pdf()} opens the file \code{file} and the PDF commands needed to
plot any graphics requested are sent to that file.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.pdf}, \dots, \file{Rplot999.pdf},
\file{Rplot1000.pdf}, \dots.

The \code{family} argument can be used to specify a PDF-specific
font family as the initial/default font for the device.

If a device-independent \R{} graphics font family is specified (e.g., via
\code{par(family=)} in the graphics package), the PDF device makes use
of the PostScript font mappings to convert the \R{} graphics font family
to a PDF-specific font family description.  (See the
documentation for \code{\LinkA{pdfFonts}{pdfFonts}}.)

\R{} does \emph{not} embed fonts in the PDF file, so it is only
straightforward to use mappings to the font families that can be
assumed to be available in any PDF viewer: \code{"Times"}
(equivalently \code{"serif"}), \code{"Helvetica"} (equivalently
\code{"sans"}) and \code{"Courier"} (equivalently \code{"mono"}).
Other families may be specified, but it is the user's responsibility
to ensure that these fonts are available on the system and third-party
software, e.g., Ghostscript, may be required to embed the fonts so
that the PDF can be included in other documents (e.g., LaTeX): see
\code{\LinkA{embedFonts}{embedFonts}}.  The URW-based families described for
\code{\LinkA{postscript}{postscript}} can be used with viewers
set up to use URW fonts, which is usual with those based on
\code{xpdf} or Ghostscript.
Since \code{\LinkA{embedFonts}{embedFonts}} makes use of Ghostscript, it should be
able to embed the URW-based families for use with other viewers.

See \code{\LinkA{postscript}{postscript}} for details of encodings, as the internal
code is shared between the drivers.  The native PDF encoding is given
in file \file{PDFDoc.enc}.

\code{pdf} writes uncompressed PDF.  It is primarily intended for
producing PDF graphics for inclusion in other documents, and
PDF-includers such as \code{pdftex} are usually able to handle
compression: there are a large number of PDF compression utilities
such as \samp{pdftk}.

The PDF produced is fairly simple, with each page being represented
as a single stream.  The \R{} graphics model does not distinguish
graphics objects at the level of the driver interface.

The \code{version} argument declares the version of PDF that gets
produced.  The version must be at least 1.4 for semi-transparent
output to be understood, and at least 1.3 if CID fonts are to be used:
if these features are used the version number will be increased (with
a warning).  Specifying a low version number is useful if you want to
produce PDF output that can be viewed on older or non-Adobe PDF
viewers.  (PDF 1.4 requires Acrobat 5 or later.)

Line widths as controlled by \code{par(lwd=)} are in multiples of
1/96 inch.  Multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch, which is
also the `pixel' size assumed for graphics parameters such as
\code{"cra"}.

The \code{paper} argument sets the \samp{/MediaBox} entry in the file,
which defaults to \code{width} by \code{height}.  If it is set to
something other than \code{"special"}, a device region of the
specified size is (by default) centred on the rectangle given by the
paper size: if either \code{width} or \code{height} is less
than \code{0.1} or too large to give a total margin of 0.5 inch, it is
reset to the corresponding paper dimension minus 0.5.  Thus if you
want the default behaviour of \code{\LinkA{postscript}{postscript}} use
\code{pdf(paper="a4r", width=0, height=0)} to centre the device region
on a landscape A4 page with 0.25 inch margins.

When the background colour is fully transparent (as is the initial
default value), the PDF produced does not paint the background.
Almost all PDF viewers will use a white canvas so the visual effect is
if the background were white.  This will not be the case when printing
onto coloured paper, though.
\end{Details}
%
\begin{Section}{Color models}
The default color model is RGB, and model \code{"gray"} maps RGB
colors to greyscale using perceived luminosity (biased towards green).
\code{"cmyk"} outputs in CMYK colorspace.  Nothing in \R{} specifies the
interpretation of the RGB or CMYK color spaces, and the simplest
possible conversion to CMYK is used
(\url{http://en.wikipedia.org/wiki/CMYK_color_model#Mapping_RGB_to_CMYK}).
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are as a multiple of 1/96 inch, with no minimum. 
\item Circles of any radius are allowed.  Unless \code{useDingbats =
    FALSE}, opaque circles of less than 10 big
points radius are rendered using char 108 in the Dingbats font:
all semi-transparent and larger circles using a Bzier
curve for each quadrant.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
If you see problems with PDF output, do remember that the
problem is much more likely to be in your viewer than in \R{}.  Try
another viewer if possible.  Symptoms for which the viewer has been at
fault are apparent grids on image plots (turn off graphics
anti-aliasing in your viewer if you) and missing or incorrect glyphs
in text (viewers silently doing font substitution).

Unfortunately the default viewers on most Linux and Mac OS X systems
have these problems, and no obvious way to turn off graphics anti-aliasing.

Acrobat Reader does not use the fonts specified but rather emulates
them from multiple-master fonts.  This can be seen in imprecise
centering of characters, for example the multiply and divide signs in
Helvetica.  This can be circumvented by embedding fonts where
possible.  Most other viewers substitute fonts, e.g. URW fonts for the
standard Helvetica and Times fonts, and these too often have different
font metrics from the true fonts.

Acrobat Reader 5.x and later can be extended by support for Asian and
(so-called) Central European fonts, and these will be needed for the
full use of encodings other than Latin-1.  See
\url{http://www.adobe.com/products/acrobat/acrrasianfontpack.html} for
Reader 6.x to 8.x, and \url{http://www.adobe.com/downloads/updates}
for 9.x.

On some systems the default plotting character \code{pch = 1} is
displayed in some PDF viewers incorrectly as a \code{"q"}
character.  (These seem to be viewers based on the \samp{poppler} PDF
rendering library). This may be due to incorrect or incomplete mapping
of font names to those used by the system.  Adding the following lines
to \file{\textasciitilde{}/.fonts.conf} or \file{/etc/fonts/local.conf} may circumvent
this problem.
\begin{alltt}
<alias binding="same">
       <family>ZapfDingbats</family>
       <accept><family>Dingbats</family></accept>
</alias>
  \end{alltt}

\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{pdfFonts}{pdfFonts}}, \code{\LinkA{pdf.options}{pdf.options}},
\code{\LinkA{embedFonts}{embedFonts}},
\code{\LinkA{Devices}{Devices}},
\code{\LinkA{postscript}{postscript}}.
\code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}} and (on Mac OS X only) \code{\LinkA{quartz}{quartz}}
for other devices that can produce PDF.

More details of font families and encodings and especially handling
text in a non-Latin-1 encoding and embedding fonts can be found in

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## Test function for encodings
TestChars <- function(encoding="ISOLatin1", ...)
{
    pdf(encoding=encoding, ...)
    par(pty="s")
    plot(c(-1,16), c(-1,16), type="n", xlab="", ylab="",
         xaxs="i", yaxs="i")
         title(paste("Centred chars in encoding", encoding))
    grid(17, 17, lty=1)
    for(i in c(32:255)) {
        x <- i %% 16
        y <- i %/% 16
        points(x, y, pch=i)
    }
    dev.off()
}
## there will be many warnings.
TestChars("ISOLatin2")
## this does not view properly in older viewers.
TestChars("ISOLatin2", family="URWHelvetica")
## works well for viewing in gs-based viewers, and often in xpdf.

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{pdf.options}{Auxiliary Function to Set/View Defaults for Arguments of pdf}{pdf.options}
\keyword{device}{pdf.options}
%
\begin{Description}\relax
The auxiliary function \code{pdf.options} can be used to set or view
(if called without arguments) the default values for some of the
arguments to \code{\LinkA{pdf}{pdf}}.

\code{pdf.options} needs to be called before calling \code{pdf},
and the default values it sets can be overridden by supplying
arguments to \code{pdf}.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
pdf.options(..., reset = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments \code{width}, \code{height}, \code{onefile},
\code{family}, \code{title}, \code{fonts}, \code{paper},
\code{encoding}, \code{pointsize}, \code{bg}, \code{fg},
\code{pagecentre}, \code{useDingbats}, \code{colormodel} 
and \code{fillOddEven} can be supplied.
\item[\code{reset}] logical: should the defaults be reset to their
`factory-fresh' values?
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If both \code{reset = TRUE} and \code{...} are supplied the defaults
are first reset to the `factory-fresh' values and then the new
values are applied.
\end{Details}
%
\begin{Value}
A named list of all the defaults.  If any arguments are
supplied the return values are the old values and the result has the
visibility flag turned off.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{pdf}{pdf}}, \code{\LinkA{ps.options}{ps.options}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
pdf.options(bg = "pink")
utils::str(pdf.options())
pdf.options(reset = TRUE) # back to factory-fresh
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{pictex}{A PicTeX Graphics Driver}{pictex}
\keyword{device}{pictex}
%
\begin{Description}\relax
This function produces graphics suitable for inclusion in TeX and
LaTeX documents.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pictex(file = "Rplots.tex", width = 5, height = 4, debug = FALSE,
       bg = "white", fg = "black")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] the file where output will appear.
\item[\code{width}] The width of the plot in inches.
\item[\code{height}] the height of the plot in inches.
\item[\code{debug}] should debugging information be printed.
\item[\code{bg}] the background color for the plot.  Ignored.
\item[\code{fg}] the foreground color for the plot.  Ignored.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This driver does not have any font metric information, so the use of
\code{\LinkA{plotmath}{plotmath}} is not supported.

Multiple plots will be placed as separate environments in the output file.

Line widths are ignored except when setting the spacing of line textures.
\code{pch="."} corresponds to a square of side 1pt.

This device does not support colour (nor does the PicTeX package),
and all colour settings are ignored.
\end{Details}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 5 inches by 5 inches.
\item There is no \code{pointsize} argument: the default size is
interpreted as 10 point.
\item The only font family is \code{cmss10}.
\item Line widths are only used when setting the spacing on line textures.
\item Circle of any radius are allowed.
\item Colour is not supported.

\end{itemize}

\end{Section}
%
\begin{Author}\relax
This driver was provided by Valerio Aimale
\email{valerio@svpop.com.dist.unige.it}
of the Department of Internal Medicine, University of Genoa, Italy.
\end{Author}
%
\begin{References}\relax
Knuth, D. E. (1984)
\emph{The TeXbook.}
Reading, MA: Addison-Wesley.

Lamport, L. (1994)
\emph{LATEX: A Document Preparation System.}
Reading, MA: Addison-Wesley.

Goossens, M., Mittelbach, F. and Samarin, A. (1994)
\emph{The LATEX Companion.}
Reading, MA: Addison-Wesley.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{Devices}{Devices}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

pictex()
plot(1:11,(-5:5)^2, type='b', main="Simple Example Plot")
dev.off()
##--------------------
## Not run: 
%% LaTeX Example
\documentclass{article}
\usepackage{pictex}
\begin{document}
%...
\begin{figure}[h]
  \centerline{\input{Rplots.tex}}
  \caption{}
\end{figure}
%...
\end{document}

%%-- plain TeX Example --
\input pictex
$$ \input Rplots.tex $$

## End(Not run)
##--------------------
unlink("Rplots.tex")
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{plotmath}{Mathematical Annotation in R}{plotmath}
\aliasA{atop}{plotmath}{atop}
\aliasA{bar}{plotmath}{bar}
\aliasA{bgroup}{plotmath}{bgroup}
\aliasA{bold}{plotmath}{bold}
\aliasA{bolditalic}{plotmath}{bolditalic}
\aliasA{displaystyle}{plotmath}{displaystyle}
\aliasA{dot}{plotmath}{dot}
\aliasA{frac}{plotmath}{frac}
\aliasA{group}{plotmath}{group}
\aliasA{hat}{plotmath}{hat}
\aliasA{inf}{plotmath}{inf}
\aliasA{integral}{plotmath}{integral}
\aliasA{italic}{plotmath}{italic}
\aliasA{over}{plotmath}{over}
\aliasA{phantom}{plotmath}{phantom}
\aliasA{plain}{plotmath}{plain}
\aliasA{ring}{plotmath}{ring}
\aliasA{scriptscriptstyle}{plotmath}{scriptscriptstyle}
\aliasA{scriptstyle}{plotmath}{scriptstyle}
\aliasA{sup}{plotmath}{sup}
\aliasA{symbol}{plotmath}{symbol}
\aliasA{textstyle}{plotmath}{textstyle}
\aliasA{underline}{plotmath}{underline}
\aliasA{widehat}{plotmath}{widehat}
\aliasA{widetilde}{plotmath}{widetilde}
\keyword{aplot}{plotmath}
%
\begin{Description}\relax
If the \code{text} argument to one of the text-drawing functions
(\code{\LinkA{text}{text}}, \code{\LinkA{mtext}{mtext}}, \code{\LinkA{axis}{axis}},
\code{\LinkA{legend}{legend}}) in \R{} is an expression, the argument is
interpreted as a mathematical expression and the output will be
formatted according to TeX-like rules.  Expressions can also be used
for titles, subtitles and x- and y-axis labels (but not for axis
labels on \code{persp} plots).

In most cases other language objects (names and calls, including
formulas) are coerced to expressions and so can also be used.  
\end{Description}
%
\begin{Details}\relax
 A mathematical expression must obey the normal rules of
syntax for any \R{} expression, but it is interpreted according to very
different rules than for normal \R{} expressions.

It is possible to produce many different mathematical symbols, generate
sub- or superscripts, produce fractions, etc.

The output from \code{demo(plotmath)} includes several tables which
show the available features.  In these tables, the columns of grey text
show sample \R{} expressions, and the columns of black text show the
resulting output.

The available features are also described in the tables below:


\Tabular{ll}{
\bold{Syntax} & \bold{Meaning} \\{}

\code{x + y}   & x plus y   \\{}
\code{x - y}   & x minus y \\{}
\code{x*y}    & juxtapose x and y \\{}
\code{x/y}    & x forwardslash y \\{}
\code{x \%+-\% y}   & x plus or minus y \\{}
\code{x \%/\% y}   & x divided by y \\{}
\code{x \%*\% y}   & x times y \\{}
\code{x \%.\% y}   & x cdot y \\{}
\code{x[i]}   & x subscript i \\{}
\code{x\textasciicircum{}2}    & x superscript 2 \\{}
\code{paste(x, y, z)} & juxtapose x, y, and z \\{}
\code{sqrt(x)}   & square root of x \\{}
\code{sqrt(x, y)}   & yth root of x \\{}
\code{x == y}   & x equals y \\{}
\code{x != y}   & x is not equal to y \\{}
\code{x < y}   & x is less than y \\{}
\code{x <= y}   & x is less than or equal to y \\{}
\code{x > y}   & x is greater than y \\{}
\code{x >= y}   & x is greater than or equal to y \\{}
\code{x \%\textasciitilde{}\textasciitilde{}\% y}   & x is approximately equal to y \\{}
\code{x \%=\textasciitilde{}\% y}   & x and y are congruent \\{}
\code{x \%==\% y}   & x is defined as y \\{}
\code{x \%prop\% y}  & x is proportional to y \\{}
\code{plain(x)}   & draw x in normal font \\{}
\code{bold(x)}   & draw x in bold font \\{}
\code{italic(x)}   & draw x in italic font \\{}
\code{bolditalic(x)} & draw x in bolditalic font \\{}
\code{symbol(x)} & draw x in symbol font \\{}
\code{list(x, y, z)} & comma-separated list \\{}
\code{...}    & ellipsis (height varies) \\{}
\code{cdots}   & ellipsis (vertically centred) \\{}
\code{ldots}   & ellipsis (at baseline) \\{}
\code{x \%subset\% y} & x is a proper subset of y \\{}
\code{x \%subseteq\% y} & x is a subset of y \\{}
\code{x \%notsubset\% y} & x is not a subset of y \\{}
\code{x \%supset\% y} & x is a proper superset of y \\{}
\code{x \%supseteq\% y} & x is a superset of y \\{}
\code{x \%in\% y}   & x is an element of y \\{}
\code{x \%notin\% y} & x is not an element of y \\{}
\code{hat(x)}   & x with a circumflex \\{}
\code{tilde(x)}   & x with a tilde \\{}
\code{dot(x)} & x with a dot \\{}
\code{ring(x)}   & x with a ring \\{}
\code{bar(xy)}   & xy with bar \\{}
\code{widehat(xy)}   & xy with a wide circumflex \\{}
\code{widetilde(xy)} & xy with a wide tilde \\{}
\code{x \%<->\% y}   & x double-arrow y \\{}
\code{x \%->\% y}   & x right-arrow y \\{}
\code{x \%<-\% y}   & x left-arrow y \\{}
\code{x \%up\% y}   & x up-arrow y \\{}
\code{x \%down\% y}  & x down-arrow y \\{}
\code{x \%<=>\% y}   & x is equivalent to y \\{}
\code{x \%=>\% y}   & x implies y \\{}
\code{x \%<=\% y}   & y implies x \\{}
\code{x \%dblup\% y}   & x double-up-arrow y \\{}
\code{x \%dbldown\% y} & x double-down-arrow y \\{}
\code{alpha} -- \code{omega} & Greek symbols \\{}
\code{Alpha} -- \code{Omega} & uppercase Greek symbols \\{}
\code{theta1, phi1, sigma1, omega1} & cursive Greek symbols\\{}
\code{Upsilon1} & capital upsilon with hook\\{}
\code{aleph} & first letter of Hebrew alphabet\\{}
\code{infinity}   & infinity symbol \\{}
\code{partialdiff} & partial differential symbol \\{}
\code{nabla} & nabla, gradient symbol\\{}
\code{32*degree}   & 32 degrees \\{}
\code{60*minute}   & 60 minutes of angle \\{}
\code{30*second}   & 30 seconds of angle \\{}
\code{displaystyle(x)} & draw x in normal size (extra spacing) \\{}
\code{textstyle(x)}  & draw x in normal size \\{}
\code{scriptstyle(x)} & draw x in small size \\{}
\code{scriptscriptstyle(x)} & draw x in very small size \\{}
\code{underline(x)}   & draw x underlined\\{}
\code{x \textasciitilde{}\textasciitilde{} y}        & put extra space between x and y \\{}
\code{x + phantom(0) + y} & leave gap for "0", but don't draw it \\{}
\code{x + over(1, phantom(0))} & leave vertical gap for "0" (don't draw) \\{}
\code{frac(x, y)}   & x over y \\{}
\code{over(x, y)}   & x over y \\{}
\code{atop(x, y)}   & x over y (no horizontal bar) \\{}
\code{sum(x[i], i==1, n)} & sum x[i] for i equals 1 to n \\{}
\code{prod(plain(P)(X==x), x)} & product of P(X=x) for all values of x \\{}
\code{integral(f(x)*dx, a, b)} & definite integral of f(x) wrt x \\{}
\code{union(A[i], i==1, n)} & union of A[i] for i equals 1 to n \\{}
\code{intersect(A[i], i==1, n)} & intersection of A[i] \\{}
\code{lim(f(x), x \%->\% 0)} & limit of f(x) as x tends to 0 \\{}
\code{min(g(x), x > 0)} & minimum of g(x) for x greater than 0 \\{}
\code{inf(S)}        & infimum of S \\{}
\code{sup(S)}   & supremum of S \\{}
\code{x\textasciicircum{}y + z}   & normal operator precedence \\{}
\code{x\textasciicircum{}(y + z)}    & visible grouping of operands \\{}
\code{x\textasciicircum{}\{y + z\}}  & invisible grouping of operands \\{}
\code{group("(",list(a, b),"]")} & specify left and right delimiters \\{}
\code{bgroup("(",atop(x,y),")")} & use scalable delimiters \\{}
\code{group(lceil, x, rceil)} & special delimiters \\{}
}

The symbol font uses Adobe Symbol encoding so, for example, a lower
case mu can be obtained either by the special symbol \code{mu} or by
\code{symbol("m")}.  This provides access to symbols that have no
special symbol name, for example, the universal, or forall, symbol is
\code{symbol("\bsl{}042")}.

Note to TeX users: TeX's \samp{\bsl{}Upsilon} is \code{Upsilon1}, TeX's
\samp{\bsl{}varepsilon} is close to \code{epsilon}, and there is no
equivalent of TeX's \samp{\bsl{}epsilon}.  TeX's \samp{\bsl{}varpi} is close to
\code{omega1}.  \code{vartheta}, \code{varphi} and \code{varsigma} are
allowed as synonyms for \code{theta1}, \code{phi1} and \code{sigma1}.

\code{sigma1} is also known as \code{stigma}, its Unicode name.

Control characters (e.g. \samp{\bsl{}n}) are not interpreted in character
strings in plotmath, unlike normal plotting.

The fonts used are taken from the current font family, and so can be
set by \code{\LinkA{par}{par}(family=)} in base graphics, and
\code{\LinkA{gpar}{gpar}(fontfamily=)} in package \pkg{grid}.
\end{Details}
%
\begin{Section}{Other symbols}
On many OSes and some graphics devices many other symbols are available as
part of the standard text font, and all of the symbols in the Adobe
Symbol encoding are in principle available \emph{via} changing the
font face or (see `Details') plotmath: see the examples section
of \code{\LinkA{points}{points}} for a function to display them.  (`In
principle' because some of the glyphs are missing from some
implementations of the symbol font.)  Unfortunately,
\code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}} have support for little
more than European and CJK characters and the Adobe Symbol encoding
(and in a few fonts, also Cyrillic characters).

In a UTF-8 locale any Unicode character can be entered, perhaps as a
\samp{\bsl{}uxxxx} or \samp{\bsl{}Uxxxxxxxx} escape sequence, but the issue is
whether the graphics device is able to display the character.  The
widest range of characters is likely to be available in the
\code{\LinkA{X11}{X11}} device using cairo: see its help page for how
installing additional fonts can help.

In non-UTF-8 locales there is normally no support for symbols not in
the languages for which the current encoding was intended.
\end{Section}
%
\begin{References}\relax
Murrell, P. and Ihaka, R. (2000) An approach to providing
mathematical annotation in plots.
\emph{Journal of Computational and Graphical Statistics},
\bold{9}, 582--599.

The symbol codes can be found in octal in the Adobe reference manuals,
e.g. for Postscript
\url{http://www.adobe.com/products/postscript/pdfs/PLRM.pdf}
or PDF
\url{http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf}
and in decimal, octal and hex at
\url{http://www.stat.auckland.ac.nz/~paul/R/CM/AdobeSym.html}.
\end{References}
%
\begin{SeeAlso}\relax
\code{demo(plotmath)},
\code{\LinkA{axis}{axis}},
\code{\LinkA{mtext}{mtext}},
\code{\LinkA{text}{text}},
\code{\LinkA{title}{title}},
\code{\LinkA{substitute}{substitute}}
\code{\LinkA{quote}{quote}}, \code{\LinkA{bquote}{bquote}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

x <- seq(-4, 4, len = 101)
y <- cbind(sin(x), cos(x))
matplot(x, y, type = "l", xaxt = "n",
        main = expression(paste(plain(sin) * phi, "  and  ",
                                plain(cos) * phi)),
        ylab = expression("sin" * phi, "cos" * phi), # only 1st is taken
        xlab = expression(paste("Phase Angle ", phi)),
        col.main = "blue")
axis(1, at = c(-pi, -pi/2, 0, pi/2, pi),
     labels = expression(-pi, -pi/2, 0, pi/2, pi))


## How to combine "math" and numeric variables :
plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
for(i in 2:9)
    text(i,i+1, substitute(list(xi,eta) == group("(",list(x,y),")"),
                           list(x=i, y=i+1)))
## note that both of these use calls rather than expressions.
##
text(1,10,  "Derivatives:", adj=0)
text(1,9.6, expression(
 "             first: {f * minute}(x) " == {f * minute}(x)), adj=0)
text(1,9.0, expression(
 "     second: {f * second}(x) "        == {f * second}(x)), adj=0)


plot(1:10, 1:10)
text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y))
text(4, 8.4, "expression(hat(beta) == (X^t * X)^{-1} * X^t * y)",
     cex = .8)
text(4, 7, expression(bar(x) == sum(frac(x[i], n), i==1, n)))
text(4, 6.4, "expression(bar(x) == sum(frac(x[i], n), i==1, n))",
     cex = .8)
text(8, 5, expression(paste(frac(1, sigma*sqrt(2*pi)), " ",
                            plain(e)^{frac(-(x-mu)^2, 2*sigma^2)})),
     cex = 1.2)

## some other useful symbols
plot.new(); plot.window(c(0,4), c(15,1))
text(1, 1, "universal", adj=0); text(2.5, 1,  "\\042")
text(3, 1, expression(symbol("\042")))
text(1, 2, "existential", adj=0); text(2.5, 2,  "\\044")
text(3, 2, expression(symbol("\044")))
text(1, 3, "suchthat", adj=0); text(2.5, 3,  "\\047")
text(3, 3, expression(symbol("\047")))
text(1, 4, "therefore", adj=0); text(2.5, 4,  "\\134")
text(3, 4, expression(symbol("\134")))
text(1, 5, "perpendicular", adj=0); text(2.5, 5,  "\\136")
text(3, 5, expression(symbol("\136")))
text(1, 6, "circlemultiply", adj=0); text(2.5, 6,  "\\304")
text(3, 6, expression(symbol("\304")))
text(1, 7, "circleplus", adj=0); text(2.5, 7,  "\\305")
text(3, 7, expression(symbol("\305")))
text(1, 8, "emptyset", adj=0); text(2.5, 8,  "\\306")
text(3, 8, expression(symbol("\306")))
text(1, 9, "angle", adj=0); text(2.5, 9,  "\\320")
text(3, 9, expression(symbol("\320")))
text(1, 10, "leftangle", adj=0); text(2.5, 10,  "\\341")
text(3, 10, expression(symbol("\341")))
text(1, 11, "rightangle", adj=0); text(2.5, 11,  "\\361")
text(3, 11, expression(symbol("\361")))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{png}{BMP, JPEG, PNG and TIFF graphics devices}{png}
\aliasA{bmp}{png}{bmp}
\aliasA{jpeg}{png}{jpeg}
\aliasA{tiff}{png}{tiff}
\keyword{device}{png}
%
\begin{Description}\relax
Graphics devices for JPEG, PNG or TIFF format bitmap files.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bmp(filename = "Rplot%03d.bmp",
    width = 480, height = 480, units = "px",
    pointsize = 12, bg = "white", res = NA, ...,
    type = c("cairo", "Xlib", "quartz"), antialias)

jpeg(filename = "Rplot%03d.jpeg",
     width = 480, height = 480, units = "px",
     pointsize = 12, quality = 75, bg = "white", res = NA, ...,
     type = c("cairo", "Xlib", "quartz"), antialias)

png(filename = "Rplot%03d.png",
    width = 480, height = 480, units = "px",
    pointsize = 12, bg = "white",  res = NA, ...,
    type = c("cairo", "Xlib", "quartz"), antialias)

tiff(filename = "Rplot%03d.tiff",
     width = 480, height = 480, units = "px", pointsize = 12,
     compression = c("none", "rle", "lzw", "jpeg", "zip"),
     bg = "white", res = NA,  ...,
     type = c("cairo", "Xlib", "quartz"), antialias)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] the name of the output file.
The page number is substituted if a C integer format is included in
the character string, as in the default.  (The result must be less
than \code{PATH\_MAX} characters long, and may be truncated if not.
See \code{\LinkA{postscript}{postscript}} for further details.)  Tilde expansion
is performed where supported by the platform.
\item[\code{width}] the width of the device.
\item[\code{height}] the height of the device.
\item[\code{units}] The units in which \code{height} and \code{width} are
given.  Can be \code{px} (pixels, the default), \code{in} (inches),
\code{cm} or \code{mm}.
\item[\code{pointsize}] the default pointsize of plotted text, interpreted as
big points (1/72 inch) at \code{res} dpi.
\item[\code{bg}] the initial background colour: can be overridden by setting
par("bg").
\item[\code{quality}] the `quality' of the JPEG image, as a
percentage.  Smaller values will give more compression but also more
degradation of the image.
\item[\code{compression}] the type of compression to be used.
\item[\code{res}] The nominal resolution in dpi which will be recorded in the
bitmap file, if a positive integer.  Also used for \code{units}
other than the default, and to convert points to pixels.
\item[\code{...}] for \code{type = "Xlib"} only, additional arguments to
the underlying \code{\LinkA{X11}{X11}} device, such as \code{gamma} and
\code{fonts}.

\item[\code{type}] character string, one of \code{"Xlib"} or \code{"quartz"}
(some Mac OS X builds) or \code{"cairo"}.  The latter will only be
available if the system was compiled with support for cairo --
otherwise \code{"Xlib"} will be used.  The default is set by
\code{\LinkA{getOption}{getOption}("bitmapType")} -- the `out of the box'
default is \code{"quartz"} or \code{"cairo"} where available,
otherwise \code{"Xlib"}.

\item[\code{antialias}] for \code{type = "cairo"}, giving the type of
anti-aliasing (if any) to be used.  See \code{\LinkA{X11}{X11}}.  The
default is set by \code{\LinkA{X11.options}{X11.options}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Plots in PNG and JPEG format can easily be converted to many other
bitmap formats, and both can be displayed in modern web
browsers.  The PNG format is lossless and is best for line
diagrams and blocks of colour.  The JPEG format is lossy,
but may be useful for image plots, for example.  BMP is a standard
format on Windows.  TIFF is a meta-format: the default format written
by \code{tiff} is lossless and stores RGB (and alpha where
appropriate) values uncompressed---such files are widely accepted,
which is their main virtue over PNG.

\code{png} supports transparent backgrounds: use \code{bg =
  "transparent"}.  Not all PNG viewers render files with transparency
correctly.  When transparency is in use in the \code{type = "Xlib"}
variant a very light grey is used as the background and so appear as
transparent if used in the plot. This allows opaque white to be used,
as in the example.  The \code{type = "cairo"} and \code{type =
  "cairo1"} variants allows semi-transparent colours, including on a
transparent or semi-transparent background.

\code{tiff(type = "cairo")} supports semi-transparent colours,
including on a transparent or semi-transparent background.

\R{} can be compiled without support for each of these devices: this
will be reported if you attempt to use them on a system where they are
not supported.  For \code{type = "Xlib"} they may not be usable unless
the X11 display is available to the owner of the \R{} process.
\code{type = "cairo"} requires cairo 1.2 or later.  \code{type =
  "quartz"} uses the \code{\LinkA{quartz}{quartz}} device and so is only
available where that is (on some Mac OS X builds: see
\code{\LinkA{capabilities}{capabilities}("aqua")}).

By default no resolution is recorded in the file.  Viewers will often
assume a nominal resolution of 72dpi when none is recorded.  As
resolutions in PNG files are recorded in pixels/metre, the reported
dpi value will be changed slightly.

For graphics parameters that make use of dimensions in inches
(including font sizes in points) the resolution used is \code{res} (or
72dpi if unset).

\code{png} will use a palette if there are less than 256 colours on
the page, and record a 24-bit RGB file otherwise (or a 32-bit RGBA
file if \code{type = "cairo"} and non-opaque colours are used).
\end{Details}
%
\begin{Value}
A plot device is opened: nothing is returned to the \R{} interpreter.
\end{Value}
%
\begin{Section}{Warnings}
Note that by default the \code{width} and \code{height} are in pixels
not inches.  A warning will be issued if both are less than 20.

If you plot more than one page on one of these devices and do not
include something like \code{\%d} for the sequence number in
\code{file}, the file will contain the last page plotted.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is in pixels.
\item Font sizes are in big points interpreted at \code{res} dpi.
\item The default font family is Helvetica.
\item Line widths in 1/96 inch, minimum one pixel for \code{type =
      "Xlib"}, 0.01 for \code{type = "cairo"}.
\item For \code{type = "Xlib"} circle radii are in pixels with
minimum one.
\item Colours are interpreted by the viewing application.

\end{itemize}


For \code{type = "quartz"} see the help for \code{\LinkA{quartz}{quartz}}.
\end{Section}
%
\begin{Note}\relax
For \code{type = "Xlib"} these devices are based on the \code{\LinkA{X11}{X11}}
device.  The colour model used will be that set up by
\code{X11.options} at the time the first Xlib-based devices was opened
(or the first after all such devices have been closed).
\end{Note}
%
\begin{Author}\relax
Guido Masarotto and Brian Ripley
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{dev.print}{dev.print}}

\code{\LinkA{capabilities}{capabilities}} to see if these devices are
supported by this build of \R{}, and if \code{type = "cairo"} is supported.

\code{\LinkA{bitmap}{bitmap}} provides an alternative way to generate PNG and
JPEG plots that does not depend on accessing the X11 display but does
depend on having GhostScript installed.  (Devices \code{GDD} in
CRAN package \pkg{GDD} and \code{CairoJPEG} / \code{CairoPNG} in CRAN
package \pkg{Cairo} are further alternatives using several other
additional pieces of software.)
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## these examples will work only if the devices are available
## and cairo or an X11 display or a Mac OS X display is available.

## copy current plot to a (large) PNG file
## Not run: dev.print(png, file="myplot.png", width=1024, height=768)

png(file="myplot.png", bg="transparent")
plot(1:10)
rect(1, 5, 3, 7, col="white")
dev.off()

## will make myplot1.jpeg and myplot2.jpeg
jpeg(file="myplot%d.jpeg")
example(rect)
dev.off()
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{postscript}{PostScript Graphics}{postscript}
\aliasA{.ps.prolog}{postscript}{.ps.prolog}
\keyword{device}{postscript}
%
\begin{Description}\relax
\code{postscript} starts the graphics device driver for producing
PostScript graphics.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
postscript(file = ifelse(onefile, "Rplots.ps", "Rplot%03d.ps"),
           onefile, family, title, fonts, encoding, bg, fg,
           width, height, horizontal, pointsize,
           paper, pagecentre, print.it, command,
           colormodel, useKerning, fillOddEven)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.  If it is
\code{""}, the output is piped to the command given by the argument
\code{command}.
If it is of the form \code{"|cmd"}, the output is piped to the
command given by \file{cmd}.

For use with \code{onefile = FALSE} give a \code{printf} format such
as \code{"Rplot\%03d.ps"} (the default in that case).  The string
should not otherwise contain a \code{\%}: if it is really necessary,
use \code{\%\%} in the string for \code{\%} in the file name.
A single integer format matching the \LinkA{regular expression}{regular expression}
\code{"\%[\#0 +=-]*[0-9.]*[diouxX]"} is allowed.

\item[\code{onefile}] logical: if true (the default) allow multiple figures
in one file.  If false, generate a file name containing the page
number for each page and use an EPSF header and no
\code{DocumentMedia} comment.  Defaults to the \code{TRUE}.
\item[\code{family}] the initial font family to be used, normally as a
character string.  See the section `Families'.  Defaults to
\code{"Helvetica"}.
\item[\code{title}] title string to embed as the \code{Title} comment in the
file.  Defaults to \code{"R Graphics Output"}.
\item[\code{fonts}] a character vector specifying additional \R{} graphics font
family names for font families whose declarations will be included
in the PostScript file and are available for use with the device.
See `Families' below.  Defaults to \code{NULL}.
\item[\code{encoding}] the name of an encoding file.  Defaults to
\code{"default"}.  The latter is interpreted as
\file{"ISOLatin1.enc"} unless the locale is recognized as
corresponding to a language using ISO 8859-\{5,7,13,15\} or KOI8-\{R,U\}.
The file is looked for in the \file{enc} directory of package
\pkg{grDevices} if the path does not contain a path separator.  An
extension \code{".enc"} can be omitted.

\item[\code{bg}] the initial background color to be used.  If
\code{"transparent"} (or any other non-opaque colour), no background
is painted.  Defaults to \code{"transparent"}.
\item[\code{fg}] the initial foreground color to be used.  Defaults to
\code{"black"}.
\item[\code{width, height}] the width and height of the graphics region in
inches.  Default to t\code{0}.

If \code{paper != "special"} and \code{width} or \code{height} is less
than \code{0.1} or too large to give a total margin of 0.5 inch, it is
reset to the corresponding paper dimension minus 0.5.

\item[\code{horizontal}] the orientation of the printed image, a logical.
Defaults to true, that is landscape orientation on paper sizes
with width less than height.
\item[\code{pointsize}] the default point size to be used.  Strictly
speaking, in bp, that is 1/72 of an inch, but approximately in
points.  Defaults to \code{12}.
\item[\code{paper}] the size of paper in the printer.  The choices are
\code{"a4"}, \code{"letter"} (or \code{"us"}), \code{"legal"} and
\code{"executive"} (and these can be capitalized).
Also, \code{"special"} can be used, when arguments \code{width}
and \code{height} specify the paper size.  A further choice is
\code{"default"} (the default): If this is selected, the papersize
is taken from the option \code{"papersize"} if that is set and to
\code{"a4"} if it is unset or empty.
\item[\code{pagecentre}] logical: should the device region be centred on the
page?  Defaults to true.
\item[\code{print.it}] logical: should the file be printed when the device is
closed?  (This only applies if \code{file} is a real file name.)
Defaults to false.
\item[\code{command}] the command to be used for `printing'.  Defaults
to \code{"default"}, the value of option \code{"printcmd"}.  The
length limit is \code{2*PATH\_MAX},
typically 8096 bytes.

\item[\code{colormodel}] a character string describing the color model:
currently allowed values as \code{"rgb"}, \code{"rgb-nogray"},
\code{"gray"} and \code{"cmyk"}.  Defaults to \code{"rgb"}.
\item[\code{useKerning}] logical.  Should kerning corrections be included in
setting text and calculating string widths?  Defaults to \code{TRUE}.
\item[\code{fillOddEven}] logical controlling the polygon fill mode:  see
\code{\LinkA{polygon}{polygon}} for details.  Default \code{FALSE}.   
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
All arguments except \code{file} default to values given by
\code{\LinkA{ps.options}{ps.options}()}.  The ultimate defaults are quoted in the
arguments section.

\code{postscript} opens the file \code{file} and the PostScript
commands needed to plot any graphics requested are written to that
file.  This file can then be printed on a suitable device to obtain
hard copy.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.ps}, \dots, \file{Rplot999.ps},
\file{Rplot1000.ps}, \dots.

The postscript produced for a single \R{} plot is EPS (\emph{Encapsulated
PostScript}) compatible, and can be included into other documents,
e.g., into LaTeX, using \code{\bsl{}includegraphics\{<filename>\}}.  For use
in this way you will probably want to use \code{\LinkA{setEPS}{setEPS}()} to
set the defaults as \code{horizontal = FALSE, onefile = FALSE, paper =
    "special"}.  Note that the bounding box is for the \emph{device}
region: if you find the white space around the plot region excessive,
reduce the margins of the figure region via \code{\LinkA{par}{par}(mar=)}.

Most of the PostScript prologue used is taken from the \R{} character
vector \code{.ps.prolog}.  This is marked in the output, and can be
changed by changing that vector.  (This is only advisable for
PostScript experts: the standard version is in
\code{namespace:grDevices}.)

A PostScript device has a default family, which can be set by the user
via \code{family}.  If other font families are to be used when drawing
to the PostScript device, these must be declared when the device is
created via \code{fonts};  the font family names for this argument are
\R{} graphics font family names (see the documentation for
\code{\LinkA{postscriptFonts}{postscriptFonts}}).

Line widths as controlled by \code{par(lwd=)} are in multiples of
1/96 inch: multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch, which is
also the `pixel' size assumed for graphics parameters such as
\code{"cra"}.

When the background colour is fully transparent (as is the initial
default value), the PostScript produced does not paint the
background. Almost all PostScript viewers will use a white canvas so
the visual effect is if the background were white.  This will not be
the case when printing onto coloured paper, though.
\end{Details}
%
\begin{Section}{Families}
Font families are collections of fonts covering the five font faces,
(conventionally plain, bold, italic, bold-italic and symbol) selected
by the graphics parameter \code{\LinkA{par}{par}(font=)} or the grid
parameter \code{\LinkA{gpar}{gpar}(fontface=)}.  Font families can be
specified either as an an initial/default font family for the device
via the \code{family} argument or after the device is opened by
the graphics parameter \code{\LinkA{par}{par}(family=)} or the grid
parameter \code{\LinkA{gpar}{gpar}(fontfamily=)}.  Families which will be
used in addition to the initial family must be specified in the
\code{fonts} argument when the device is opened.

Font families are declared via a call to \code{\LinkA{postscriptFonts}{postscriptFonts}}.

The argument \code{family} specifies the initial/default font family
to be used.  In normal use it is one of \code{"AvantGarde"},
\code{"Bookman"}, \code{"Courier"}, \code{"Helvetica"},
\code{"Helvetica-Narrow"}, \code{"NewCenturySchoolbook"},
\code{"Palatino"} or \code{"Times"}, and refers to the standard Adobe
PostScript fonts families of those names which are included (or
cloned) in all common PostScript devices.

Many PostScript emulators (including those based on
\code{ghostscript}) use the URW equivalents of these fonts, which are
\code{"URWGothic"}, \code{"URWBookman"}, \code{"NimbusMon"},
\code{"NimbusSan"}, \code{"NimbusSanCond"}, \code{"CenturySch"},
\code{"URWPalladio"} and \code{"NimbusRom"} respectively.  If your
PostScript device is using URW fonts, you will obtain access to more
characters and more appropriate metrics by using these names.  To make
these easier to remember, \code{"URWHelvetica" == "NimbusSan"} and
\code{"URWTimes" == "NimbusRom"} are also supported.

Another type of family makes use of CID-keyed fonts for East Asian
languages -- see \code{\LinkA{postscriptFonts}{postscriptFonts}}.

The \code{family} argument is normally a character string naming a
font family, but family objects generated by \code{\LinkA{Type1Font}{Type1Font}}
and \code{\LinkA{CIDFont}{CIDFont}} are also accepted.
For compatibility with earlier versions of \R{}, the initial family can
also be specified as a vector of four or five afm files.

Note that \R{} does not embed the font(s) used in the PostScript output:
see \code{\LinkA{embedFonts}{embedFonts}} for a utility to help do so.

Viewers and embedding applications frequently substitute fonts for
those specified in the family, and the substitute will often have
slightly different font metrics. \code{useKerning=TRUE} spaces the
letters in the string using kerning corrections for the intended
family: this may look uglier than \code{useKerning=FALSE}.
\end{Section}
%
\begin{Section}{Encodings}
Encodings describe which glyphs are used to display the character codes
(in the range 0--255).  Most commonly \R{} uses ISOLatin1 encoding, and
the examples for \code{\LinkA{text}{text}} are in that encoding.  However,
the encoding used on machines running \R{} may well be different, and by
using the \code{encoding} argument the glyphs can be matched to
encoding in use.  This suffices for European and Cyrillic languages,
but not for CJK languages.  For the latter, composite CID fonts are
used.  These fonts are useful for other languages: for example they
may contain Greek glyphs. (The rest of this section applies only when CID
fonts are not used.)

None of this will matter if only ASCII characters (codes 32--126) are
used as all the encodings (except \code{"TeXtext"}) agree over that
range.  Some encodings are supersets of ISOLatin1, too.  However, if
accented and special characters do not come out as you expect, you may
need to change the encoding.  Some other encodings are supplied with
\R{}: \code{"WinAnsi.enc"} and \code{"MacRoman.enc"} correspond to the
encodings normally used on Windows and Classic Mac OS (at least by
Adobe), and \code{"PDFDoc.enc"} is the first 256 characters of the
Unicode encoding, the standard for PDF.  There are also encodings
\code{"ISOLatin2.enc"}, \code{"CP1250.enc"}, \code{"ISOLatin7.enc"}
(ISO 8859-13), \code{"CP1257.enc"}, and \code{"ISOLatin9.enc"} (ISO
8859-15), \code{"Cyrillic.enc"} (ISO 8859-5), \code{"KOI8-R.enc"},
\code{"KOI8-U.enc"}, \code{"CP1251.enc"}, \code{"Greek.enc"} (ISO
8859-7) and \code{"CP1253.enc"}.  Note that many glyphs in these
encodings are not in the fonts corresponding to the standard families.
(The Adobe ones for all but Courier, Helvetica and Times cover little
more than Latin-1, whereas the URW ones also cover Latin-2, Latin-7,
Latin-9 and Cyrillic but no Greek.  The Adobe exceptions cover the
Latin character sets, but not the Euro.)

If you specify the encoding, it is your responsibility to ensure that
the PostScript font contains the glyphs used.  One issue here is the Euro
symbol which is in the WinAnsi and MacRoman encodings but may well not
be in the PostScript fonts.  (It is in the URW variants; it is not in
the supplied Adobe Font Metric files.)

There is an exception.  Character 45 (\code{"-"}) is always set
as minus (its value in Adobe ISOLatin1) even though it is hyphen in
the other encodings.  Hyphen is available as character 173 (octal
0255) in all the Latin encodings, Cyrillic and Greek.  (This can be
entered as \code{"\bsl{}uad"} in a UTF-8 locale.)  There are some
discrepancies in accounts of glyphs 39 and 96: the supplied encodings
(except CP1250 and CP1251) treat these as `quoteright' and
`quoteleft' (rather than `quotesingle'/`acute'
and `grave' respectively), as they are in the Adobe
documentation.
\end{Section}
%
\begin{Section}{TeX fonts}
TeX has traditionally made use of fonts such as Computer Modern which
are encoded rather differently, in a 7-bit encoding.  This encoding
can be specified by \code{encoding = "TeXtext.enc"}, taking care that
the ASCII characters \code{< > \bsl{} \_ \{ \}} are not available in those
fonts.

There are supplied families \code{"ComputerModern"} and
\code{"ComputerModernItalic"} which use this encoding, and which are
only supported for \code{postscript} (and not \code{pdf}).  They are
intended to use with the Type 1 versions of the TeX CM fonts.  It will
normally be possible to include such output in TeX or LaTeX provided
it is processed with \code{dvips -Ppfb -j0} or the equivalent on your
system. (\code{-j0} turns off font subsetting.)  When \code{family =
    "ComputerModern"} is used, the italic/bold-italic fonts used are
slanted fonts (\code{cmsl10} and \code{cmbxsl10}).  To use text italic
fonts instead, set \code{family = "ComputerModernItalic"}.

These families use the TeX math italic and  symbol fonts for a
comprehensive but incomplete coverage of the glyphs covered by the
Adobe symbol font in other families.  This is achieved by
special-casing the postscript code generated from the supplied
\file{CM\_symbol\_10.afm}.
\end{Section}
%
\begin{Section}{Color models}
The default color model is RGB, with pure gray colors expressed as
greyscales.  Color model \code{"rgb-nogray"} uses only RGB, model
\code{"cmyk"} only CMYK, and model \code{"gray"} only greyscales (and
selecting any other colour is an error).  Nothing in \R{} specifies the
interpretation of the RGB or CMYK color spaces, and the simplest
possible conversion to CMYK is used
(\url{http://en.wikipedia.org/wiki/CMYK_color_model#Mapping_RGB_to_CMYK}).
\end{Section}
%
\begin{Section}{Printing}
A postscript plot can be printed via \code{postscript} in two ways.
\begin{enumerate}

\item Setting \code{print.it = TRUE} causes the command given in
argument \code{command} to be called with argument \code{"file"}
when the device is closed.  Note that the plot file is not deleted
unless \code{command} arranges to delete it.

\item \code{file=""} or \code{file="|cmd"} can be used to print
using a pipe on systems that support \file{popen}.  Failure to open the
command will probably be reported to the terminal but not to
\file{popen}, in which case close the device by \code{dev.off}
immediately.

\end{enumerate}

\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are as a multiple of 1/96 inch, with no minimum. 
\item Circle of any radius are allowed.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
If you see problems with postscript output, do remember that the
problem is much more likely to be in your viewer than in \R{}.  Try
another viewer if possible.  Symptoms for which the viewer has been at
fault are apparent grids on image plots (turn off graphics
anti-aliasing in your viewer if you can) and missing or incorrect glyphs
in text (viewers silently doing font substitution).

Unfortunately the default viewers on most Linux and Mac OS X systems
have these problems, and no obvious way to turn off graphics anti-aliasing.
\end{Note}
%
\begin{Author}\relax
Support for Computer Modern fonts is based on a contribution by
Brian D'Urso \email{durso@hussle.harvard.edu}.
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscriptFonts}{postscriptFonts}},
\code{\LinkA{Devices}{Devices}},
and \code{\LinkA{check.options}{check.options}} which is called from both
\code{\LinkA{ps.options}{ps.options}} and \code{postscript}.
\code{\LinkA{cairo\_ps}{cairo.Rul.ps}} for another device that can produce PostScript.

More details of font families and encodings and especially handling
text in a non-Latin-1 encoding and embedding fonts can be found in

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)
## Not run: 
# open the file "foo.ps" for graphics output
postscript("foo.ps")
# produce the desired graph(s)
dev.off()              # turn off the postscript device
postscript("|lp -dlw")
# produce the desired graph(s)
dev.off()              # plot will appear on printer

# for URW PostScript devices
postscript("foo.ps", family = "NimbusSan")

## for inclusion in Computer Modern TeX documents, perhaps
postscript("cm_test.eps", width = 4.0, height = 3.0,
           horizontal = FALSE, onefile = FALSE, paper = "special",
           family = "ComputerModern", encoding = "TeXtext.enc")
## The resultant postscript file can be used by dvips -Ppfb -j0.

## To test out encodings, you can use
TestChars <- function(encoding="ISOLatin1", family="URWHelvetica")
{
    postscript(encoding=encoding, family=family)
    par(pty="s")
    plot(c(-1,16), c(-1,16), type="n", xlab="", ylab="",
         xaxs="i", yaxs="i")
    title(paste("Centred chars in encoding", encoding))
    grid(17, 17, lty=1)
    for(i in c(32:255)) {
        x <- i %% 16
        y <- i %/% 16
        points(x, y, pch=i)
    }
    dev.off()
}
## there will be many warnings.  We use URW to get a complete enough
## set of font metrics.
TestChars()
TestChars("ISOLatin2")
TestChars("WinAnsi")

## End(Not run)

\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{postscriptFonts}{PostScript and PDF Font Families}{postscriptFonts}
\aliasA{pdfFonts}{postscriptFonts}{pdfFonts}
\keyword{device}{postscriptFonts}
%
\begin{Description}\relax
These functions handle the translation of a \R{} graphics
font family name to a PostScript or PDF font description, used by the
\code{\LinkA{postscript}{postscript}} or \code{\LinkA{pdf}{pdf}} graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
postscriptFonts(...)
pdfFonts(...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] either character strings naming mappings to display,
or named arguments specifying mappings to add or change.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If these functions are called with no argument they list all the
existing mappings, whereas if they are called with named arguments
they add (or change) mappings.

A PostScript or PDF device is created with a default font family (see the
documentation for \code{\LinkA{postscript}{postscript}}), but it is also possible
to specify a font family when drawing to the device (for example, see
the documentation for \code{"family"} in \code{\LinkA{par}{par}} and for
\code{"fontfamily"} in \code{\LinkA{gpar}{gpar}} in the \pkg{grid} package).

The font family sent to the device is a simple string name, which must be
mapped to a set of PostScript fonts.  Separate lists of mappings for
\code{postscript} and \code{pdf} devices are  maintained for the
current \R{} session and can be added to by the user.

The \code{postscriptFonts} and \code{pdfFonts} functions can be used
to list existing mappings and to define new mappings.  The
\code{\LinkA{Type1Font}{Type1Font}} and \code{\LinkA{CIDFont}{CIDFont}} functions can be
used to create new mappings, when the \code{xxxFonts} function is used
to add them to the database.  See the examples.

Default mappings are provided for three device-independent family
names: \code{"sans"} for a sans-serif font (to \code{"Helvetica"}),
\code{"serif"} for a serif font (to \code{"Times"}) and \code{"mono"}
for a monospaced font (to \code{"Courier"}).

Mappings for a number of standard Adobe fonts (and URW equivalents)
are also provided: \code{"AvantGarde"},
\code{"Bookman"}, \code{"Courier"}, \code{"Helvetica"},
\code{"Helvetica-Narrow"}, \code{"NewCenturySchoolbook"},
\code{"Palatino"} and \code{"Times"};
\code{"URWGothic"}, \code{"URWBookman"}, \code{"NimbusMon"},
\code{"NimbusSan"} (synonym \code{"URWHelvetica"}),
\code{"NimbusSanCond"}, \code{"CenturySch"}, \code{"URWPalladio"} and
\code{"NimbusRom"} (synonym \code{"URWTimes"}).

There are also mappings for \code{"ComputerModern"} and
\code{"ComputerModernItalic"}.

Finally, there are some default mappings for East Asian locales
described in a separate section.

The specification of font metrics and encodings is described in the help
for the \code{\LinkA{postscript}{postscript}} function.

The fonts are not embedded in the resulting PostScript or PDF file, so
software including the PostScript or PDF plot file should either embed
the font outlines (usually from \file{.pfb} or \file{.pfa} files) or
use DSC comments to instruct the print spooler or including
application to do so (see also \code{\LinkA{embedFonts}{embedFonts}}).

A font family has both an \R{}-level name, the argument name used when
\code{postscriptFonts} was called, and an internal name, the
\code{family} component.  These two names are the same for all the
pre-defined font families.

Once a font family is in use it cannot be changed.  `In use'
means that it has been specified \emph{via} a \code{family} or
\code{fonts} argument to an invocation of the same graphics device
already in the \R{} session.  (For these purposes \code{xfig} counts the
same as \code{postscript} but only uses some of the predefined mappings.)
\end{Details}
%
\begin{Value}
A list of one or more font mappings.
\end{Value}
%
\begin{Section}{East Asian fonts}
There are some default mappings for East Asian locales:\\{}
\code{"Japan1"}, \code{"Japan1HeiMin"}, \code{"Japan1GothicBBB"},
and \code{"Japan1Ryumin"} for Japanese;
\code{"Korea1"} and \code{"Korea1deb"} for Korean;
\code{"GB1"} (Simplified Chinese) for mainland China and Singapore;
\code{"CNS1"} (Traditional Chinese) for Hong Kong and Taiwan.

These refer to the following fonts

\Tabular{ll}{
Japan1 (PS) & \code{HeiseiKakuGo-W5}\\{} & Linotype Japanese printer font\\{}
Japan1 (PDF) & \code{KozMinPro-Regular-Acro}\\{} & from Adobe Reader 7.0 Japanese Font Pack\\{}
Japan1HeiMin (PS) & \code{HeiseiMin-W3}\\{} & Linotype Japanese printer font\\{}
Japan1HeiMin (PDF) & \code{HeiseiMin-W3-Acro}\\{} & from Adobe Reader 7.0 Japanese Font Pack\\{}
Japan1GothicBBB & \code{GothicBBB-Medium}\\{} & Japanese-market PostScript printer font\\{}
Japan1Ryumin & \code{Ryumin-Light}\\{} & Japanese-market PostScript printer font\\{}
Korea1 (PS) & \code{Baekmuk-Batang}\\{}  & TrueType font found on some Linux systems\\{}
Korea1 (PDF) & \code{HYSMyeongJoStd-Medium-Acro}\\{}  & from Adobe Reader 7.0 Korean Font Pack\\{}
Korea1deb (PS) & \code{Batang-Regular}\\{}  & another name for Baekmuk-Batang\\{}
Korea1deb (PDF) & \code{HYGothic-Medium-Acro}\\{}  & from Adobe Reader 4.0 Korean Font Pack\\{}
GB1 (PS) & \code{BousungEG-Light-GB}\\{}  & TrueType font found on some Linux systems\\{}
GB1 (PDF) & \code{STSong-Light-Acro}\\{}  & from Adobe Reader 7.0 Simplified Chinese Font Pack\\{}
CNS1 (PS) & \code{MOESung-Regular}\\{} & Ken Lunde's CJKV resources\\{}
CNS1 (PDF) & \code{MSungStd-Light-Acro}\\{}  & from Adobe Reader 7.0 Traditional Chinese Font Pack\\{}
}
\code{Baekmuk-Batang} can be found at \url{ftp://ftp.mizi.com/pub/baekmuk/}.
\code{BousungEG-Light-GB} can be found at
\url{ftp://ftp.gnu.org/pub/non-gnu/chinese-fonts-truetype/}.
Ken Lunde's CJKV resources are at
\url{ftp://ftp.oreilly.com/pub/examples/nutshell/cjkv/adobe/samples/}.
These will need to be installed or otherwise made available to the
postscript/PDF interpreter such as ghostscript (and not all
interpreters can handle TrueType fonts).

You may well find that your postscript/PDF interpreters has been set
up to provide aliases for many of these fonts.  For example,
ghostscript on Windows can optionally be installed to map common CJK
fonts names to Windows TrueType fonts.  (You may want to add the
\code{-Acro} versions as well.)

Adding a mapping for a CID-keyed font is for gurus only.
\end{Section}
%
\begin{Author}\relax
Support for Computer Modern fonts is based on a contribution by
Brian D'Urso \email{durso@hussle.harvard.edu}.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}};  \code{\LinkA{Type1Font}{Type1Font}}
and \code{\LinkA{CIDFont}{CIDFont}} for specifying new font mappings.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
postscriptFonts()
## This duplicates "ComputerModernItalic".
CMitalic <- Type1Font("ComputerModern2",
                      c("CM_regular_10.afm", "CM_boldx_10.afm",
                        "cmti10.afm", "cmbxti10.afm",
                         "CM_symbol_10.afm"),
                      encoding = "TeXtext.enc")
postscriptFonts(CMitalic = CMitalic)

## A CID font for Japanese using a different CMap and
## corresponding cmapEncoding.
`Jp_UCS-2` <- CIDFont("TestUCS2",
                  c("Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm"),
                  "UniJIS-UCS2-H", "UCS-2")
pdfFonts(`Jp_UCS-2` = `Jp_UCS-2`)
names(pdfFonts())
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{ps.options}{Auxiliary Function to Set/View Defaults for Arguments of postscript}{ps.options}
\aliasA{setEPS}{ps.options}{setEPS}
\aliasA{setPS}{ps.options}{setPS}
\keyword{device}{ps.options}
%
\begin{Description}\relax
The auxiliary function \code{ps.options} can be used to set or view
(if called without arguments) the default values for some of the
arguments to \code{\LinkA{postscript}{postscript}}.

\code{ps.options} needs to be called before calling \code{postscript},
and the default values it sets can be overridden by supplying
arguments to \code{postscript}.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
ps.options(..., reset = FALSE, override.check = FALSE)

setEPS(...)
setPS(...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments \code{onefile}, \code{family}, \code{title},
\code{fonts},
\code{encoding}, \code{bg}, \code{fg}, \code{width}, \code{height},
\code{horizontal}, \code{pointsize},  \code{paper},
\code{pagecentre}, \code{print.it}, \code{command},
\code{colormodel} and \code{fillOddEven} can be supplied.  \code{onefile},
\code{horizontal} and \code{paper} are \emph{ignored}
for \code{setEPS} and \code{setPS}.
\item[\code{reset}] logical: should the defaults be reset to their
`factory-fresh' values?
\item[\code{override.check}] logical argument passed to
\code{\LinkA{check.options}{check.options}}.  See the Examples.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If both \code{reset = TRUE} and \code{...} are supplied the defaults
are first reset to the `factory-fresh' values and then the new
values are applied.

For backwards compatibility argument \code{append} is accepted but
ignored with a warning.

\code{setEPS} and \code{setPS} are wrappers to set defaults
appropriate for figures for inclusion in documents (the default size
is 7 inches square unless \code{width} or \code{height} is supplied)
and for spooling to a PostScript printer respectively.  For historical
reasons the latter is the ultimate default.
\end{Details}
%
\begin{Value}
A named list of all the previous defaults.  If \code{...} or
\code{reset = TRUE} is supplied the result has the visibility flag
turned off.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf.options}{pdf.options}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
ps.options(bg = "pink")
utils::str(ps.options())

### ---- error checking of arguments: ----
ps.options(width=0:12, onefile=0, bg=pi)
# override the check for 'width', but not 'bg':
ps.options(width=0:12, bg=pi, override.check = c(TRUE,FALSE))
utils::str(ps.options())
ps.options(reset = TRUE) # back to factory-fresh
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{quartz}{MacOS X Quartz Device}{quartz}
\methaliasA{quartz.options}{quartz}{quartz.options}
\keyword{device}{quartz}
%
\begin{Description}\relax
\code{quartz} starts a graphics device driver for the Mac OS X System.
It supports plotting both to the screen (the default) and to various
graphics file formats.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
quartz(title, width, height, pointsize, family, fontsmooth, antialias,
       type, file = NULL, bg, canvas, dpi)

quartz.options(..., reset = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{title}] title for the Quartz window (applies to on-screen output
only), default \code{"Quartz \%d"}.  A C-style format for an integer
will be substituted by the device number (see the \code{file}
argument to \code{\LinkA{postscript}{postscript}} for further details).
\item[\code{width}] the width of the plotting area in inches.  Default \code{7}.
\item[\code{height}] the height of the plotting area in inches.  Default \code{7}.
\item[\code{pointsize}] the default pointsize to be used.  Default \code{12}.
\item[\code{family}] this is the family name of the font
that will be used by the device.  Default \code{"Helvetica"}.
\item[\code{fontsmooth}] logical specifying if fonts should be
smoothed. Default \code{TRUE}.  Currently unused.
\item[\code{antialias}] whether to use antialiasing.  Default \code{TRUE}.
\item[\code{type}] the type of output to use.  See `Details' for
more information.  Default \code{"native"}.
\item[\code{file}] an optional target for the graphics device. The default,
\code{NULL}, selects a default name where one is needed.  See
`Details' for more information.
\item[\code{bg}] the initial background colour to use for the device.  Default
\code{"transparent"}.  An opaque colour such as \code{"white"} will
normally be required on off-screen types that support transparency
such as \code{"png"} and \code{"tiff"}.
\item[\code{canvas}] canvas colour to use for an on-screen device.  Default
\code{"white"}, and will be forced to be an opaque colour.
\item[\code{dpi}] resolution of the output.  The default (\code{NA\_real\_})
for an on-screen display defaults to the resolution of
the main screen, and to 72 dpi otherwise.  See `Details'.
\item[\code{...}] Any of the arguments to \code{quartz} except \code{file}.
\item[\code{reset}] logical: should the defaults be reset to their defaults?
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The defaults for all but one of the arguments of \code{quartz} are set
by \code{quartz.options}: the `Arguments' section gives the
`factory-fresh' defaults.

The Quartz graphics device supports a variety of output types.
On-screen output types are \code{""} or \code{"native"} (picks the best
possible on-screen output), \code{"Cocoa"} (Mac OS X 10.4 and later)
and \code{"Carbon"} (not currently implemented -- potentially
Mac OS X 10.3 and earlier).   Off-screen output
types produce output files and utilize the \code{file} argument.
\code{type = "pdf"} gives PDF output. The following bitmap formats may
be supported (on OS X 10.4 and later): \code{"png"}, \code{"jpeg"},
\code{"jpg"}, \code{"jpeg2000"}, \code{"tif"}, \code{"tiff"},
\code{"gif"}, \code{"psd"} (Adobe Photoshop), \code{"bmp"} (Windows
bitmap), \code{"sgi"} and \code{"pict"}.  (The availability of some
formats is OS-version-dependent.)

To reproduce the default of older Quartz devices on-screen, set
\code{dpi = 72} (for a permanent solution set
\code{quartz.options(dpi = 72)}).

The \code{file} argument is used for off-screen drawing.  The actual
file is only created when the device is closed (e.g. using
\code{dev.off()}).  For the bitmap devices, the page number is
substituted if a C integer format is included in the character string,
e.g. \code{Rplot\%03d.png}.  (The result must be less than
\code{PATH\_MAX} characters long, and may be truncated if not. See
\code{\LinkA{postscript}{postscript}} for further details.)  If a \code{file}
argument is not supplied, the default is \code{Rplots.pdf} or
\code{Rplot\%03d.\var{type}}.

If a device-independent \R{} graphics font family is specified
(e.g., via \code{par(family=)} in the graphics package),
the Quartz device makes use of the Quartz font database
(see \code{quartzFonts}) to convert the R graphics font family
to a Quartz-specific font family description.

On-screen devices are launched with a semi-transparent canvas.  Once a
new plot is created, the canvas is first painted with the
\code{canvas} colour and then the current background colour (which can
be transparent or semi-transparent).  Off-screen devices have no
canvas colour, and so start with a transparent background where
possible (e.g. \code{type="png"} and \code{type="tiff"}) -- otherwise
it appears that a solid white canvas is assumed in the Quartz code.

\code{title} can be used for on-screen output.  It must be a single
character string with an optional integer printf-style format that
will be substituted by the device number.  It is also optionally used
(without a format) to give a title to a PDF file.

Calling \code{quartz()} sets \code{\LinkA{.Device}{.Device}} to \code{"quartz"}
for on-screen devices and to \code{"quartz\_off\_screen"} otherwise.
\end{Details}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Arial.
\item Line widths are a multiple of 1/96 inch with no minimum set by \R{}.
\item Circle radii are real-valued with no minimum set by \R{}.
\item Colour interpretation is by the viewer, including the screen
display.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{quartzFonts}{quartzFonts}}, \code{\LinkA{Devices}{Devices}}.

\code{\LinkA{png}{png}} for way to access the bitmap types of this device
via \R{}'s standard bitmap devices.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## put something this is your .Rprofile to customize the defaults
setHook(packageEvent("grDevices", "onLoad"),
        function(...) grDevices::quartz.options(width=8, height=6,
                                                pointsize=10))

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{quartzFonts}{quartz Fonts}{quartzFonts}
\aliasA{quartzFont}{quartzFonts}{quartzFont}
\keyword{device}{quartzFonts}
%
\begin{Description}\relax
These functions handle the translation of a device-independent R graphics
font family name to a quartz font description.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
quartzFont(family)

quartzFonts(...)           
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{family}] a character vector containing the four PostScript font
names for plain, bold, italic, and bolditalic versions of
a font family.
\item[\code{...}] either character strings naming mappings to display,
or new (named) mappings to define.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
A quartz device is created with a default font (see
the documentation for \code{quartz}), but it is also possible
to specify a font family when drawing to the device
(for example, see the documentation for \code{gpar} in the
grid package).

The font family sent to the device is a simple string name, which must be
mapped to something more specific to quartz fonts.  A list of
mappings is maintained and can be modified by the user.

The \code{quartzFonts} function can be used to list existing
mappings and to define new mappings.  The \code{quartzFont}
function can be used to create a new mapping.

Default mappings are provided for three device-independent font family
names: \code{"sans"} for a sans-serif font, \code{"serif"} for a serif
font and \code{"mono"} for a monospaced font.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{quartz}{quartz}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
quartzFonts()
quartzFonts("mono")
## Not run: 
## for CJK locales you can use something like
quartzFonts(sans = quartzFont(rep("AppleGothic", 4)),
            serif = quartzFont(rep("AppleMyungjp", 4)))
## since the default fonts may well not have the glyphs needed

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{recordGraphics}{Record graphics operations}{recordGraphics}
\keyword{device}{recordGraphics}
%
\begin{Description}\relax
Records arbitrary code on the graphics engine display list.
Useful for encapsulating calculations with graphical output
that depends on the calculations.
Intended \emph{only} for expert use.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
recordGraphics(expr, list, env)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{expr}] object of mode \code{\LinkA{expression}{expression}} or \code{call} or
an unevaluated expression.
\item[\code{list}] a list defining the environment in which \code{expr} is to
be evaluated.
\item[\code{env}] An \code{\LinkA{environment}{environment}} specifying
where \R{} looks for objects not found in
\code{envir}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The code in \code{expr} is evaluated in an environment constructed
from \code{list}, with \code{env} as the parent of that environment.

All three arguments are saved on the graphics engine display list
so that on a device resize or copying between devices, the original
evaluation environment can be recreated and the code can be
re-evaluated to reproduce the graphical output.
\end{Details}
%
\begin{Value}
The value from evaluating \code{expr}.
\end{Value}
%
\begin{Section}{Warning}
This function is not intended for general use.  Incorrect or
improper use of this function could lead to unintended and/or
undesirable results.

An example of acceptable use is querying the current state
of a graphics device or graphics system setting and then
calling a graphics function.

An example of improper use would be calling the \code{assign} function
to performing assignments in the global environment.
\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{eval}{eval}} 
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

plot(1:10)
# This rectangle remains 1inch wide when the device is resized
recordGraphics(
  {
    rect(4, 2,
         4 + diff(par("usr")[1:2])/par("pin")[1], 3)
  },
  list(),
  getNamespace("graphics"))
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{recordPlot}{Record and Replay Plots}{recordPlot}
\aliasA{print.recordedplot}{recordPlot}{print.recordedplot}
\aliasA{replayPlot}{recordPlot}{replayPlot}
\keyword{iplot}{recordPlot}
%
\begin{Description}\relax
Functions to save the current plot in an \R{} variable, and to replay it.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
recordPlot()
replayPlot(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A saved plot.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
These functions record and replay the displaylist of the current
graphics device.  The returned object is of class
\code{"recordedplot"}, and \code{replayPlot} acts as a \code{print}
method for that class.
\end{Details}
%
\begin{Value}
\code{recordPlot} returns an object of class \code{"recordedplot"}.

\code{replayPlot} has no return value.
\end{Value}
%
\begin{Section}{Warning}
The format of recorded plots may change between \R{} versions.
Recorded plots should \strong{not} be used as a permanent
storage format for \R{} plots.

\R{} will always attempt to replay a recorded plot, but if the plot was 
recorded with a different \R{} version then bad things may happen.
\end{Section}
\inputencoding{latin1}
\HeaderA{rgb}{RGB Color Specification}{rgb}
\keyword{color}{rgb}
%
\begin{Description}\relax
This function creates colors corresponding to the given
intensities (between 0 and \code{max}) of the red, green and blue
primaries.

An alpha transparency value can also be specified
(0 means fully transparent and \code{max} means opaque).
If \code{alpha} is not specified, an opaque colour is generated.

The names argument may be used to provide names for the
colors.

The values returned by these functions can be used with a
\code{col=} specification in graphics functions or in \code{\LinkA{par}{par}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rgb(red, green, blue, alpha, names = NULL, maxColorValue = 1)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{red, blue, green, alpha}] numeric vectors with values in \eqn{[0, M]}{}
where \eqn{M}{} is \code{maxColorValue}.  When this is \code{255}, the
\code{red}, \code{blue}, \code{green}, and \code{alpha}
values are coerced to integers in \code{0:255} and the result is
computed most efficiently.
\item[\code{names}] character. The names for the resulting vector.
\item[\code{maxColorValue}] number giving the maximum of the color values
range, see above.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The colors may be specified by passing a matrix or dataframe as argument
\code{red}, and leaving \code{blue} and \code{green} missing.
In this case the first three columns of \code{red} are taken to be
the \code{red}, \code{green} and \code{blue} values.

Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: at the time of writing on the \code{\LinkA{pdf}{pdf}},
\code{windows}, \code{quartz} and \code{X11(type="cairo")} devices and
associated bitmap devices (\code{jpeg}, \code{png}, \code{bmp},
\code{tiff} and \code{bitmap}). They are supported by several
third-party devices such as those in packages \pkg{Cairo},
\pkg{cairoDevice} and \pkg{JavaGD}.  Only some of these
devices support semi-transparent backgrounds.

Most other graphics devices plot semi-transparent colors as fully
transparent, usually with a warning when first encountered.
\end{Details}
%
\begin{Value}
A character vector with elements of 7 or 9 characters, \code{"\#"}
followed by the red, blue, green and optionally alpha values in
hexadecimal (after rescaling to \code{0 ... 255}).
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{col2rgb}{col2rgb}}for translating \R{} colors to RGB vectors;
\code{\LinkA{rainbow}{rainbow}}, \code{\LinkA{hsv}{hsv}}, \code{\LinkA{hcl}{hcl}},
\code{\LinkA{gray}{gray}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
rgb(0,1,0)

rgb((0:15)/15, green=0, blue=0, names=paste("red",0:15,sep="."))

rgb(0, 0:12, 0, max = 255)# integer input

ramp <- colorRamp(c("red", "white"))
rgb( ramp(seq(0, 1, length = 5)), max = 255)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{rgb2hsv}{RGB to HSV Conversion}{rgb2hsv}
\keyword{color}{rgb2hsv}
\keyword{dplot}{rgb2hsv}
%
\begin{Description}\relax
\code{rgb2hsv} transforms colors
from RGB space (red/green/blue)
into HSV space (hue/saturation/value).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rgb2hsv(r, g = NULL, b = NULL, gamma = 1, maxColorValue = 255)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{r}] vector of `red' values in \eqn{[0,M]}{}, (\eqn{M
      =}{}\code{maxColorValue}) or 3-row rgb matrix.
\item[\code{g}] vector of `green' values, or \code{\LinkA{NULL}{NULL}} when
\code{r} is a matrix.
\item[\code{b}] vector of `blue' values, or \code{\LinkA{NULL}{NULL}} when
\code{r} is a matrix.
\item[\code{gamma}] a gamma-correction (supposedly applied to the
r,g,b values previously), see \code{\LinkA{hsv}{hsv}(...., gamma)}.
\item[\code{maxColorValue}] number giving the maximum of the RGB color values
range.  The default \code{255} corresponds to the typical \code{0:255}
RGB coding as in \code{\LinkA{col2rgb}{col2rgb}()}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Value (brightness) gives the amount of light in the color.\\{}
Hue describes the dominant wavelength.\\{}
Saturation is the amount of Hue mixed into the color.
\end{Details}
%
\begin{Value}
A matrix with a column for each color.  The three rows of the matrix
indicate hue, saturation and value and are named \code{"h"},
\code{"s"}, and \code{"v"} accordingly.
\end{Value}
%
\begin{Author}\relax
\R{} interface by Wolfram Fischer \email{wolfram@fischer-zim.ch};\\{}
C code mainly by Nicholas Lewin-Koh \email{nikko@hailmail.net}.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{hsv}{hsv}}, \code{\LinkA{col2rgb}{col2rgb}}, \code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## These (saturated, bright ones) only differ by hue
(rc <- col2rgb(c("red", "yellow","green","cyan", "blue", "magenta")))
(hc <- rgb2hsv(rc))
6 * hc["h",] # the hues are equispaced


(rgb3 <- floor(256 * matrix(stats::runif(3*12), 3,12)))
(hsv3 <- rgb2hsv(rgb3))
## Consistency :
stopifnot(rgb3 == col2rgb(hsv(h=hsv3[1,], s=hsv3[2,], v=hsv3[3,])),
          all.equal(hsv3, rgb2hsv(rgb3/255, maxColorValue = 1)))

## A (simplified) pure R version -- originally by Wolfram Fischer --
## showing the exact algorithm:
rgb2hsvR <- function(rgb, gamma = 1, maxColorValue = 255)
{
    if(!is.numeric(rgb)) stop("rgb matrix must be numeric")
    d <- dim(rgb)
    if(d[1] != 3) stop("rgb matrix must have 3 rows")
    n <- d[2]
    if(n == 0) return(cbind(c(h=1,s=1,v=1))[,0])
    rgb <- rgb/maxColorValue
    if(gamma != 1) rgb <- rgb ^ (1/gamma)

    ## get the max and min
    v <- apply( rgb, 2, max)
    s <- apply( rgb, 2, min)
    D <- v - s # range

    ## set hue to zero for undefined values (gray has no hue)
    h <- numeric(n)
    notgray <- ( s != v )

    ## blue hue
    idx <- (v == rgb[3,] & notgray )
    if (any (idx))
        h[idx] <- 2/3 + 1/6 * (rgb[1,idx] - rgb[2,idx]) / D[idx]
    ## green hue
    idx <- (v == rgb[2,] & notgray )
    if (any (idx))
        h[idx] <- 1/3 + 1/6 * (rgb[3,idx] - rgb[1,idx]) / D[idx]
    ## red hue
    idx <- (v == rgb[1,] & notgray )
    if (any (idx))
        h[idx] <-       1/6 * (rgb[2,idx] - rgb[3,idx]) / D[idx]

    ## correct for negative red
    idx <- (h < 0)
    h[idx] <- 1+h[idx]

    ## set the saturation
    s[! notgray] <- 0;
    s[notgray] <- 1 - s[notgray] / v[notgray]

    rbind( h=h, s=s, v=v )
}

## confirm the equivalence:
all.equal(rgb2hsv (rgb3),
          rgb2hsvR(rgb3), tol=1e-14) # TRUE
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{savePlot}{Save Cairo X11 Plot to File}{savePlot}
\keyword{utilities}{savePlot}
%
\begin{Description}\relax
Save the current page of a cairo \code{\LinkA{X11}{X11}()} device to a file. 
\end{Description}
%
\begin{Usage}
\begin{verbatim}
savePlot(filename = paste("Rplot", type, sep="."),
         type = c("png", "jpeg", "tiff", "bmp"),
         device = dev.cur())
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] filename to save to.
\item[\code{type}] file type: only \code{"png"} will be accepted for cairo
version 1.0.
\item[\code{device}] the device to save from.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Only \code{X11} devices of types \code{"cairo"} and \code{"nbcairo"}
are supported.

This works by copying the image surface to a file.  For PNG
will always be a 24-bit per pixel PNG `DirectClass' file, for
JPEG the quality is 75\% and for TIFF there is no compression.

At present the plot is saved after rendering onto the canvas (default
opaque white), so for the default \code{bg = "transparent"} the
effective background colour is the canvas colour.
\end{Details}
%
\begin{Value}
Invisible \code{NULL}.
\end{Value}
%
\begin{Note}\relax
There is a similar function of the same name but more types for
\code{windows} devices on Windows.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{X11}{X11}}, \code{\LinkA{dev.copy}{dev.copy}}, \code{\LinkA{dev.print}{dev.print}}
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{trans3d}{3D to 2D Transformation for Perspective Plots}{trans3d}
\keyword{dplot}{trans3d}
%
\begin{Description}\relax
Projection of 3-dimensional to 2-dimensional points using a 4x4
viewing transformation matrix.  Mainly for adding to
perspective plots such as \code{\LinkA{persp}{persp}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
trans3d(x,y,z, pmat)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y, z}] numeric vectors of equal length, specifying points in
3D space.
\item[\code{pmat}] a \eqn{4 \times 4}{} \emph{viewing transformation matrix},
suitable for projecting the 3D coordinates \eqn{(x,y,z)}{} into the 2D
plane using homogeneous 4D coordinates \eqn{(x,y,z,t)}{};
such matrices are returned by \code{\LinkA{persp}{persp}()}.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
a list with two components
\begin{ldescription}
\item[\code{x,y}] the projected 2d coordinates of the 3d input \code{(x,y,z)}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
 \code{\LinkA{persp}{persp}} 
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}

## See  help(persp) {after attaching the 'graphics' package}
##      -----------
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{Type1Font}{Type 1 and CID Fonts}{Type1Font}
\aliasA{CIDFont}{Type1Font}{CIDFont}
\keyword{device}{Type1Font}
%
\begin{Description}\relax
These functions are used to define the translation of a \R{} graphics
font family name to a Type 1 or CID font descriptions, used by both
the \code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}} graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
Type1Font(family, metrics, encoding = "default")

CIDFont(family, cmap, cmapEncoding, pdfresource = "")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{family}] a character string giving the name to be used internally
for a Type 1 or CID-keyed font family.  This needs to uniquely
identify each family, so if you modify a family which is in use
(see \code{\LinkA{postscriptFonts}{postscriptFonts}}) you need to change the family name.
\item[\code{metrics}] a character vector of four or five strings giving paths
to the afm (Adobe Font Metric) files for the font.
\item[\code{cmap}] the name of a CMap file for a CID-keyed font.
\item[\code{encoding}] for \code{Type1Font}, the name of an encoding file.
Defaults to \code{"default"}, which maps on Unix-alikes to
\code{"ISOLatin1.enc"} and on Windows to \code{"WinAnsi.enc"}.
Otherwise, a file name in the \file{enc} directory of the
\pkg{grDevices} package, which is used if the path does not contain a
path separator.  An extension \code{".enc"} can be omitted.
\item[\code{cmapEncoding}] 
The name of a character encoding to be used with the named CMap
file: strings will be translated to this encoding when written to
the file.
\item[\code{pdfresource}] A chunk of PDF code;  only required for using
a CID-keyed font on \code{pdf}; users should not be expected to
provide this.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For \code{Type1Fonts}, if four \file{.afm} files are supplied the
fifth is taken to be \code{"Symbol.afm"}.  Relative paths are taken
relative to the directory \file{\var{\LinkA{R\_HOME}{R.Rul.HOME}}/library/grDevices/afm}.
The fifth (symbol) font must be in \code{AdobeSym} encoding.
However, the glyphs in the first four fonts are referenced by name
and any encoding given within the \file{.afm} files is not used.

Glyphs in CID-keyed fonts are accessed by ID (number) and not by name.
The CMap file maps encoded strings (usually in a MBCS) to IDs, so
\code{cmap} and \code{cmapEncoding} specifications must match.  There
are no real bold or italic versions of CID fonts (bold/italic were
very rarely used in traditional CJK topography), and for the
\code{\LinkA{pdf}{pdf}} device all four font faces will be identical.
However, for the \code{\LinkA{postscript}{postscript}} device, bold and italic (and
bold italic) are emulated.

CID-keyed fonts are intended only for use for the glyphs of CJK
languages, which are all monospaced and are all treated as filling the
same bounding box.  (Thus \code{\LinkA{plotmath}{plotmath}} will work with such
characters, but the spacing will be less carefully controlled than
with Western glyphs.)  The CID-keyed fonts do contain other
characters, including a Latin alphabet:  non-CJK glyphs are regarded
as monospaced with half the width of CJK glyphs.  This is often the
case, but sometimes Latin glyphs designed for proportional spacing are
used (and may look odd).  We strongly recommend that CID-keyed fonts
are \bold{only} used for CJK glyphs.
\end{Details}
%
\begin{Value}
A list of class \code{"Type1Font"} or \code{"CIDFont"}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf}{pdf}},
\code{\LinkA{postscriptFonts}{postscriptFonts}}, and \code{\LinkA{pdfFonts}{pdfFonts}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## This duplicates "ComputerModernItalic".
CMitalic <- Type1Font("ComputerModern2",
                      c("CM_regular_10.afm", "CM_boldx_10.afm",
                        "cmti10.afm", "cmbxti10.afm",
                        "CM_symbol_10.afm"),
                      encoding = "TeXtext.enc")

## Not run: 
## This could be used by
postscript(family = CMitalic)
## or
postscriptFonts(CMitalic = CMitalic)  # once in a session
postscript(family = "CMitalic", encoding = "TeXtext.enc")

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{x11}{X Window System Graphics}{x11}
\aliasA{X11}{x11}{X11}
\aliasA{X11.options}{x11}{X11.options}
\keyword{device}{x11}
%
\begin{Description}\relax
\code{X11} starts a graphics device driver for the X Window System
(version 11).  This can only be done on machines/accounts that have
access to an X server.

\code{x11} is recognized as a synonym for \code{X11}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
X11(display = "", width, height, pointsize, gamma, bg, canvas,
    fonts, xpos, ypos, title, type, antialias)

X11.options(..., reset = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{display}] the display on which the graphics window will appear.
The default is to use the value in the user's environment variable
\env{DISPLAY}.  This is ignored (with a warning) if an X11 device is
already open on another display.
\item[\code{width, height}] the width and height of the plotting window, in
inches.  If \code{NA}, taken from the resources and if
not specified there defaults to \code{7} inches.  See also
`Resources'.
\item[\code{pointsize}] the default pointsize to be used.  Defaults to \code{12}.
\item[\code{gamma}] the gamma correction factor.  This value is used
to help ensure that the colours perceived are linearly related to
RGB values (see \code{\LinkA{hsv}{hsv}}).  By default 1 (default
correction).
\item[\code{bg}] colour, the initial background colour.  Default
\code{"transparent"}.
\item[\code{canvas}] colour.  The colour of the canvas, which is visible only
when the background colour is transparent.  Should be a solid colour
(and any alpha value will be ignored).  Default \code{"white"}.
\item[\code{fonts}] X11 font description strings into which weight, slant and
size will be substituted.  There are two, the first for fonts 1 to 4
and the second for font 5, the symbol font.  See section `Fonts'.
\item[\code{xpos, ypos}] integer: initial position of the top left corner of the
window, in pixels.  Negative values are from the opposite corner,
e.g. \code{xpos=-100} says the top right corner should be 100 pixels
from the right edge of the screen.  If \code{NA} (the default),
successive devices are cascaded in 20 pixel steps from the top left.
See also `Resources'.
\item[\code{title}] character string, up to 100 bytes.  With the default,
\code{""}, a suitable title is created internally.  A C-style format
for an integer will be substituted by the device number (see the
\code{file} argument to \code{\LinkA{postscript}{postscript}} for further
details).  How non-ASCII titles are handled is
implementation-dependent.
\item[\code{type}] character string, one of \code{"Xlib"} (the only type
prior to \R{} 2.7.0) or \code{"cairo"} or \code{"nbcairo"}.  The
latter two will only be available if the system was compiled with
support for cairo.  Default \code{"cairo"} where available, otherwise
\code{"Xlib"}.
\item[\code{antialias}] for cairo types, the type of anti-aliasing (if any)
to be used.  One of \code{c("default", "none", "gray", "subpixel")}.
\item[\code{reset}] logical: should the defaults be reset to their defaults?
\item[\code{...}] Any of the arguments to \code{X11}, plus \code{colortype}
and \code{maxcubesize} (see section `Colour Rendering').
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The defaults for all of the arguments of \code{X11} are set by
\code{X11.options}: the `Arguments' section gives the
`factory-fresh' defaults.

The initial size and position are only hints, and may not be acted on
by the window manager.  Also, some systems (especially laptops) are
set up to appear to have a screen of a different size to the physical
screen.

Option \code{type} selects between two separate devices: \R{} can be
built with support for neither, \code{type = "Xlib"} or both.  Where
both are available, types \code{"cairo"} and \code{"nbcairo"} offer
\begin{itemize}

\item 
antialiasing of text and lines.
\item 
translucent colours.
\item 
scalable text, including to sizes like 4.5 pt.
\item 
full support for UTF-8, so on systems with suitable fonts you can
plot in many languages on a single figure (and this will work even
in non-UTF-8 locales).  The output should be locale-independent.

\end{itemize}

\code{type = "nbcairo"} is the same device as \code{type="cairo"}
without buffering: which is faster will depend on the X11
connection.  Both will be slower than \code{type = "Xlib"}, especially
on a slow X11 connection as all the rendering is done on the machine
running \R{} rather than in the X server.

All devices which use an X11 server (including the \code{type =
    "Xlib"} versions of bitmap devices such as \code{\LinkA{png}{png}}) share
internal structures, which means that they must use the same
\code{display} and visual.  If you want to change display, first close
all such devices.
\end{Details}
%
\begin{Section}{X11 Fonts}
This section applies only to \code{type = "Xlib"}.

An initial/default font family for the device can be specified via
the \code{fonts} argument, but if a device-independent R graphics font
family is specified (e.g., via \code{par(family=)} in the graphics
package), the X11 device makes use of the X11 font database (see
\code{X11Fonts}) to convert the R graphics font family to an
X11-specific font family description.

X11 chooses fonts by matching to a pattern, and it is quite possible
that it will choose a font in the wrong encoding or which does not
contain glyphs for your language (particularly common in
\code{iso10646-1} fonts).

The \code{fonts} argument is a two-element character vector, and the
first element will be crucial in successfully using
non-Western-European fonts.  Settings that have proved useful include

\code{"-*-mincho-\%s-\%s-*-*-\%d-*-*-*-*-*-*-*"} for CJK languages and
\code{"-cronyx-helvetica-\%s-\%s-*-*-\%d-*-*-*-*-*-*-*"} for Russian.

For UTF-8 locales, the \code{XLC\_LOCALE} databases provide mappings
between character encodings, and you may need to add an entry for your
locale (e.g. Fedora Core 3 lacked one for \code{ru\_RU.utf8}).
\end{Section}
%
\begin{Section}{Cairo Fonts}
The cairo-based device works directly with font family names such as
\code{"Helvetica"} which should be selected by \code{\LinkA{par}{par}} or
\code{\LinkA{gpar}{gpar}}.  There are mappings for the three
device-independent font families, \code{"sans"} for a sans-serif font
(to \code{"Helvetica"}), \code{"serif"} for a serif font (to
\code{"Times"}) and \code{"mono"} for a monospaced font (to
\code{"Courier"}).

The font selection is handled by \code{Pango} (usually) or
\code{cairo} (on Mac OS X and perhaps elsewhere).  Both make use of
\code{fontconfig} (\url{http://wwww.fontconfig.org}) to select fonts
and so the results depend on the fonts installed on the system running
\R{} -- setting the environmnent variable \env{FC\_DEBUG} to 1 allows
some tracing of the selection process.

This works best when high-quality scalable fonts are installed,
usually in Type 1 or TrueType formats: see the ``R Installation
and Administration Manual'' for advice on how to obtain and install
such fonts.
\end{Section}
%
\begin{Section}{Resources}
The standard X11 resource \code{geometry} can be used to specify the
window position and/or size, but will be overridden by values
specified as arguments or non-\code{NA} defaults set in
\code{X11.options}.  The class looked for is \code{R\_x11}.  Note that
the resource specifies the width and height in pixels and not in
inches.  See for example
\url{http://web.mit.edu/answers/xwindows/xwindows_resources.html} and
perhaps \samp{man X} (or \url{http://www.xfree86.org/current/X.7.html}).
An example line in \file{\textasciitilde{}/.Xresources} might be
\begin{alltt}R_x11*geometry: 900x900-0+0
\end{alltt}

which specifies a 900 x 900 pixel window at the top right of the screen.
\end{Section}
%
\begin{Section}{Colour Rendering}
X11 supports several `visual' types, and nowadays almost all
systems support `truecolor' which \code{X11} will use by
default.  This uses a direct specification of any RGB colour up to the
depth supported (usually 8 bits per colour).  Other visuals make use
of a palette to support fewer colours, only grays or even only
black/white.  The palette is shared between all X11 clients, so it can
be necessary to limit the number of colours used by \R{}.

Cairo-based devices currently support only `truecolor'
visuals. (Cairo 1.6 will support other visuals.)

The default for \code{type="Xlib"} is to use the best possible colour
model for the visual of the X11 server.  This can be overridden by the
\code{colortype} argument of \code{X11.options}.  \bold{Note:} All
\code{X11} and \code{type = "Xlib"} \code{\LinkA{bmp}{bmp}}, \code{jpeg},
\code{png} and \code{tiff} devices share a \code{colortype} which is
set when the first device to be opened.  To change the
\code{colortype} you need to close \emph{all} open such devices, and
then use \code{X11.options(colortype=)}.

The colortype types are tried in the order \code{"true"},
\code{"pseudo"}, \code{"gray"} and \code{"mono"} (black or white
only).  The values \code{"pseudo"} and \code{"pseudo.cube"} provide
colour strategies for a pseudocolor visual.  The first strategy
provides on-demand colour allocation which produces exact colours until
the colour resources of the display are exhausted (when plotting will
fail).  The second allocates (if possible) a standard colour cube, and
requested colours are approximated by the closest value in the cube.

With \code{colortype} equal to \code{"pseudo.cube"} or \code{"gray"}
successively smaller palettes are tried until one is completely
allocated.  If allocation of the smallest attempt fails the device will
revert to \code{"mono"}.  For \code{"gray"} the search starts at 256
grays for a display with depth greater than 8, otherwise with half
the available colours.  For \code{"pseudo.cube"} the maximum cube size
is set by \code{X11.options(maxcolorsize=)} and defaults to
256.  With that setting the largest cube tried is 4 levels each for
RGB, using 64 colours in the palette.
\end{Section}
%
\begin{Section}{Anti-aliasing}
Anti-aliasing is only supported for cairo-based devices, and applies to
graphics and to fonts.  It is generally preferable for lines and text,
but can lead to undesirable effects for fills, e.g. for
\code{\LinkA{image}{image}} plots, and so is never used for fills.

\code{antialias = "default"} is in principle platform-dependent, but
seems most often equivalent to \code{antialias = "gray"}.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths in 1/96 inch, minimum one pixel for \code{type =
      "Xlib"}, 0.01 otherwise.
\item For \code{type = "Xlib"} circle radii are in pixels with
minimum one.
\item Colours are interpreted by the X11 server, normally in a fair
approximation to sRGB.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{X11Fonts}{X11Fonts}}, \code{\LinkA{savePlot}{savePlot}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## put something this is your .Rprofile to customize the defaults
setHook(packageEvent("grDevices", "onLoad"),
        function(...) grDevices::X11.options(width=8, height=6, xpos=0,
                                             pointsize=10))

## End(Not run)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{X11Fonts}{X11 Fonts}{X11Fonts}
\aliasA{X11Font}{X11Fonts}{X11Font}
\keyword{device}{X11Fonts}
%
\begin{Description}\relax
These functions handle the translation of a device-independent R graphics
font family name to an X11 font description.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
X11Font(font)

X11Fonts(...)      
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{font}] a character string containing an X11 font description.
\item[\code{...}] either character strings naming mappings to display,
or new (named) mappings to define.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
These functions apply only to an \code{\LinkA{X11}{X11}} device with
\code{type = "Xlib"} -- \code{X11(type = "Cairo"} uses a different
mechanism to select fonts.

Such a  device is created with a default font (see
the documentation for \code{\LinkA{X11}{X11}}), but it is also possible
to specify a font family when drawing to the device (for example, see
the documentation for \code{"family"} in \code{\LinkA{par}{par}} and for
\code{"fontfamily"} in \code{\LinkA{gpar}{gpar}} in the \pkg{grid} package).

The font family sent to the device is a simple string name, which must be
mapped to something more specific to X11 fonts.  A list of
mappings is maintained and can be modified by the user.

The \code{X11Fonts} function can be used to list existing
mappings and to define new mappings.  The \code{X11Font}
function can be used to create a new mapping.

Default mappings are provided for three device-independent font family
names: \code{"sans"} for a sans-serif font, \code{"serif"} for a serif
font and \code{"mono"} for a monospaced font.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{X11}{X11}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
X11Fonts()
X11Fonts("mono")
utopia <- X11Font("-*-utopia-*-*-*-*-*-*-*-*-*-*-*-*")
X11Fonts(utopia=utopia)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{xfig}{XFig Graphics Device}{xfig}
\keyword{device}{xfig}
%
\begin{Description}\relax
\code{xfig} starts the graphics device driver for producing XFig
(version 3.2) graphics.

The auxiliary function \code{ps.options} can be used to set and view
(if called without arguments) default values for the arguments to
\code{xfig} and \code{postscript}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xfig(file = ifelse(onefile, "Rplots.fig", "Rplot%03d.fig"),
     onefile = FALSE, encoding = "none",
     paper = "default", horizontal = TRUE,
     width = 0, height = 0, family = "Helvetica",
     pointsize = 12, bg = "transparent", fg = "black",
     pagecentre = TRUE, defaultfont = FALSE, textspecial = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.   For use
with \code{onefile = FALSE} give a C integer format such as
\code{"Rplot\%03d.fig"} (the default in that case).
(See \code{\LinkA{postscript}{postscript}} for further details.)

\item[\code{onefile}] logical: if true allow multiple figures
in one file. If false, assume only one page per file and generate a
file number containing the page number.
\item[\code{encoding}] The encoding in which to write text strings.  The
default is not to re-encode.  This can be any encoding recognized by
\code{\LinkA{iconv}{iconv}}: in a Western UTF-8 locale you probably want to
select an 8-bit encoding such as \code{latin1}, and in an East Asian
locale an \code{EUC} encoding.  If re-encoding fails, the text
strings will be written in the current encoding with a warning.
\item[\code{paper}] the size of paper region.  The choices
are \code{"A4"}, \code{"Letter"} and \code{"Legal"} (and these
can be lowercase).  A further choice is \code{"default"}, which
is the default.  If this is selected, the papersize is taken
from the option \code{"papersize"} if that is set to a non-empty
value, otherwise \code{"A4"}.
\item[\code{horizontal}] the orientation of the printed image, a
logical.  Defaults to true, that is landscape orientation.
\item[\code{width, height}] the width and height of the
graphics region in inches.  The default is to use the entire
page less a 0.5 inch overall margin in each direction.  (See
\code{\LinkA{postscript}{postscript}} for further details.)
\item[\code{family}] the font family to be used.  This must be one
of \code{"AvantGarde"}, \code{"Bookman"}, \code{"Courier"},
\code{"Helvetica"} (the default), \code{"Helvetica-Narrow"},
\code{"NewCenturySchoolbook"}, \code{"Palatino"} or
\code{"Times"}.  Any other value is replaced by
\code{"Helvetica"}, with a warning.
\item[\code{pointsize}] the default point size to be used.
\item[\code{bg}] the initial background color to be used.
\item[\code{fg}] the initial foreground color to be used.
\item[\code{pagecentre}] logical: should the device region be centred on the
page?
\item[\code{defaultfont}] logical: should the device use xfig's default
font?
\item[\code{textspecial}] logical: should the device set the textspecial flag
for all text elements. This is useful when generating pstex from xfig
figures.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Although \code{xfig} can produce multiple plots in one file, the XFig
format does not say how to separate or view them.  So
\code{onefile = FALSE} is the default.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.fig}, \dots, \file{Rplot999.fig},
\file{Rplot1000.fig}, \dots.  

Line widths as controlled by \code{par(lwd=)} are in multiples of
5/6*1/72 inch.  Multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch.  

Windows users can make use of WinFIG
(\url{http://www.schmidt-web-berlin.de/WinFIG.htm}, shareware), or
XFig under Cygwin.
\end{Details}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is the paper size with a 0.25 inch
border on all sides.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are integers, multiples of 5/432 inch.
\item Circle radii are multiples of 1/1200 inch.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
Only some line textures (\code{0 <= lty < 4}) are used.  Eventually this
may be partially remedied, but the XFig file format does not allow as
general line textures as the \R{} model.  Unimplemented line textures
are displayed as \emph{dash-double-dotted}.

There is a limit of 512 colours (plus white and black) per file.
\end{Note}
%
\begin{Author}\relax
Brian Ripley.  Support for \code{defaultFont} and \code{textSpecial}
contributed by Sebastian Fischmeister.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}},
\code{\LinkA{postscript}{postscript}},
\code{\LinkA{ps.options}{ps.options}}.
\end{SeeAlso}
\inputencoding{latin1}
\HeaderA{xy.coords}{Extracting Plotting Structures}{xy.coords}
\keyword{dplot}{xy.coords}
%
\begin{Description}\relax
\code{xy.coords} is used by many functions to obtain
x and y coordinates for plotting.  The use of this common mechanism
across all relevant \R{} functions produces a measure of consistency.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xy.coords(x, y = NULL, xlab = NULL, ylab = NULL, log = NULL,
          recycle = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the x and y coordinates of a set of points.
Alternatively, a single argument \code{x} can be provided.
\item[\code{xlab,ylab}] names for the x and y variables to be extracted.
\item[\code{log}] character, \code{"x"}, \code{"y"} or both, as for
\code{\LinkA{plot}{plot}}.  Sets negative values to \code{\LinkA{NA}{NA}} and
gives a warning.
\item[\code{recycle}] logical; if \code{TRUE}, recycle (\code{\LinkA{rep}{rep}})
the shorter of \code{x} or \code{y} if their lengths differ.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An attempt is made to interpret the arguments \code{x} and \code{y} in
a way suitable for bivariate plotting (or other bivariate procedures).

If \code{y} is \code{NULL} and \code{x} is a
\begin{description}

\item[formula:] of the form \code{yvar \textasciitilde{} xvar}. \code{xvar} and
\code{yvar} are used as x and y variables.

\item[list:] containing components \code{x} and \code{y}, these are
used to define plotting coordinates.

\item[time series:] the x values are taken to be
\code{\LinkA{time}{time}(x)} and the y values to be the time series.

\item[matrix or \code{\LinkA{data.frame}{data.frame}} with two or more
columns:] the first is assumed to contain the x values and the
second the y values.  \emph{Note} that is also true if \code{x}
has columns named \code{"x"} and \code{"y"}; these names will be
irrelevant here.

\end{description}

In any other case, the \code{x} argument is coerced to a vector and
returned as \bold{y} component where the resulting \code{x} is just
the index vector \code{1:n}.  In this case, the resulting \code{xlab}
component is set to \code{"Index"}.

If \code{x} (after transformation as above) inherits from class
\code{"POSIXt"} it is coerced to class \code{"POSIXct"}.
\end{Details}
%
\begin{Value}
A list with the components
\begin{ldescription}
\item[\code{x}] numeric (i.e., \code{"double"}) vector of abscissa values.
\item[\code{y}] numeric vector of the same length as \code{x}.
\item[\code{xlab}] \code{character(1)} or \code{NULL}, the `label' of
\code{x}.
\item[\code{ylab}] \code{character(1)} or \code{NULL}, the `label' of
\code{y}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{lines}{lines}}, \code{\LinkA{points}{points}}
and \code{\LinkA{lowess}{lowess}} are examples of functions which use this mechanism.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xy.coords(stats::fft(c(1:10)), NULL)

with(cars, xy.coords(dist ~ speed, NULL)$xlab ) # = "speed"

xy.coords(1:3, 1:2, recycle=TRUE)
xy.coords(-2:10,NULL, log="y")
##> warning: 3 y values <=0 omitted ..
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{xyTable}{Multiplicities of (x,y) Points, e.g., for a Sunflower Plot}{xyTable}
\keyword{dplot}{xyTable}
%
\begin{Description}\relax
Given (x,y) points, determine their multiplicity -- checking for
equality only up to some (crude kind of) noise.  Note that this is
special kind of 2D binning.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xyTable(x, y = NULL, digits)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] numeric vectors of the same length; alternatively other
(x,y) argument combinations as allowed by \code{\LinkA{xy.coords}{xy.coords}(x,y)}.
\item[\code{digits}] integer specifying the significant digits to be used for
determining equality of coordinates.  These are compared after
rounding them via \code{\LinkA{signif}{signif}(*,digits)}.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list with three components of same length,
\begin{ldescription}
\item[\code{x}] x coordinates, rounded and sorted.
\item[\code{y}] y coordinates, rounded (and sorted within \code{x}).
\item[\code{number}] multiplicities (positive integers); i.e.,
\code{number[i]} is the multiplicity of \code{(x[i],y[i])}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{sunflowerplot}{sunflowerplot}} which typically uses
\code{xyTable()}; \code{\LinkA{signif}{signif}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xyTable(iris[,3:4], digits = 6)

## Discretized uncorrelated Gaussian:

require(stats)
xy <- data.frame(x = round(sort(rnorm(100))), y = rnorm(100))
xyTable(xy, digits = 1)
\end{ExampleCode}
\end{Examples}
\inputencoding{latin1}
\HeaderA{xyz.coords}{Extracting Plotting Structures}{xyz.coords}
\keyword{dplot}{xyz.coords}
%
\begin{Description}\relax
Utility for obtaining consistent x, y and z coordinates and labels
for three dimensional (3D) plots.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xyz.coords(x, y = NULL, z = NULL,
           xlab = NULL, ylab = NULL, zlab = NULL,
           log = NULL, recycle = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y, z}] the x, y and z coordinates of a set of points.
Both \code{y} and \code{z} can be left at \code{NULL}.  In this
case, an attempt is made to interpret \code{x} in a way suitable for
plotting.

If the argument is a formula \code{zvar \textasciitilde{} xvar + yvar},
\code{xvar}, \code{yvar} and \code{zvar} are used as x, y and z
variables;
if the argument is a list containing components \code{x},
\code{y} and \code{z}, these are assumed to define plotting coordinates;
if the argument is a matrix or \code{\LinkA{data.frame}{data.frame}} with three
or more columns, the first is
assumed to contain the x values, the 2nd the y ones, and the 3rd the
z ones -- independently of any column names that \code{x} may have.

Alternatively two arguments \code{x} and \code{y} can be provided
(leaving \code{z = NULL}).  One may be real, the other complex;
in any other case, the arguments are coerced to vectors
and the values plotted against their indices.

\item[\code{xlab, ylab, zlab}] names for the x, y and z variables to be extracted.
\item[\code{log}] character, \code{"x"}, \code{"y"}, \code{"z"} or combinations.
Sets negative values to \code{\LinkA{NA}{NA}} and gives a warning.
\item[\code{recycle}] logical; if \code{TRUE}, recycle (\code{\LinkA{rep}{rep}}) the
shorter ones of \code{x}, \code{y} or \code{z} if their lengths differ.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list with the components
\begin{ldescription}
\item[\code{x}] numeric (i.e., \code{\LinkA{double}{double}}) vector of abscissa values.
\item[\code{y}] numeric vector of the same length as \code{x}.
\item[\code{z}] numeric vector of the same length as \code{x}.
\item[\code{xlab}] \code{character(1)} or \code{NULL}, the axis label of \code{x}.
\item[\code{ylab}] \code{character(1)} or \code{NULL}, the axis label of \code{y}.
\item[\code{zlab}] \code{character(1)} or \code{NULL}, the axis label of \code{z}.
\end{ldescription}
\end{Value}
%
\begin{Author}\relax
Uwe Ligges and Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{xy.coords}{xy.coords}} for 2D.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xyz.coords(data.frame(10*1:9, -4), y = NULL, z = NULL)

xyz.coords(1:6, stats::fft(1:6), z = NULL, xlab = "X", ylab = "Y")

y <- 2 * (x2 <- 10 + (x1 <- 1:10))
xyz.coords(y ~ x1 + x2, y = NULL, z = NULL)

xyz.coords(data.frame(x = -1:9, y = 2:12, z = 3:13), y = NULL, z = NULL,
           log = "xy")
##> Warning message: 2 x values <= 0 omitted ...
\end{ExampleCode}
\end{Examples}
\clearpage
